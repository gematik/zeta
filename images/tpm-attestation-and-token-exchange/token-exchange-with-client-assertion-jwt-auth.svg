<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="3262px" preserveAspectRatio="none" style="width:1257px;height:3262px;background:#FFFFFF;" version="1.1" viewBox="0 0 1257 3262" width="1257px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="3250.3125" style="stroke:#181818;stroke-width:0.5;" width="782.5088" x="11" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="393.7925" y="15.2822">LEI</text><rect fill="#E6E6FA" height="3233.6719" style="stroke:#181818;stroke-width:0.5;" width="586.771" x="11" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="265.2888" y="31.9229">Prim&#228;rsystem</text><rect fill="#F4A460" height="3217.0313" style="stroke:#181818;stroke-width:0.5;" width="89" x="11" y="39.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="23" y="48.5635">ZETA Client</text><rect fill="#C9FFC9" height="3250.3125" style="stroke:#181818;stroke-width:0.5;" width="446.2119" x="805.5088" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1004.2544" y="15.2822">Anbieter</text><rect fill="#F4A460" height="3233.6719" style="stroke:#181818;stroke-width:0.5;" width="446.2119" x="805.5088" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="995.4702" y="31.9229">ZETA Guard</text><g><title>ZETA</title><rect fill="#000000" fill-opacity="0.00000" height="3118.8281" width="8" x="52" y="93.2031"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="55.5" x2="55.5" y1="93.2031" y2="3212.0313"/></g><g><title/><rect fill="#FFFFFF" height="3105.8281" style="stroke:#181818;stroke-width:1;" width="10" x="50.5" y="101.2031"/></g><g><title>ZETA Attestation Service</title><rect fill="#000000" fill-opacity="0.00000" height="3118.8281" width="8" x="332.2852" y="93.2031"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="335.7852" x2="335.7852" y1="93.2031" y2="3212.0313"/></g><g><title/><rect fill="#FFFFFF" height="551.5781" style="stroke:#181818;stroke-width:1;" width="10" x="330.7852" y="342.25"/></g><g><title>TPM</title><rect fill="#000000" fill-opacity="0.00000" height="3118.8281" width="8" x="572.8877" y="93.2031"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="576.3877" x2="576.3877" y1="93.2031" y2="3212.0313"/></g><g><title/><rect fill="#FFFFFF" height="306.9688" style="stroke:#181818;stroke-width:1;" width="10" x="571.3877" y="483.0156"/></g><g><title>Konnektor or</title><rect fill="#000000" fill-opacity="0.00000" height="3118.8281" width="8" x="649.6978" y="93.2031"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="653.1978" x2="653.1978" y1="93.2031" y2="3212.0313"/></g><g><title/><rect fill="#FFFFFF" height="76.9219" style="stroke:#181818;stroke-width:1;" width="10" x="648.1978" y="1598.5781"/></g><g><title>SM.C.-B</title><rect fill="#000000" fill-opacity="0.00000" height="3118.8281" width="8" x="758.894" y="93.2031"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="762.394" x2="762.394" y1="93.2031" y2="3212.0313"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="757.394" y="1624.2188"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="3118.8281" width="8" x="864.4834" y="93.2031"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="867.9834" x2="867.9834" y1="93.2031" y2="3212.0313"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="862.9834" y="118.8438"/></g><g><title/><rect fill="#FFFFFF" height="1280.5625" style="stroke:#181818;stroke-width:1;" width="10" x="862.9834" y="1899.4688"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="3118.8281" width="8" x="1122.791" y="93.2031"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1126.291" x2="1126.291" y1="93.2031" y2="3212.0313"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="1121.291" y="2497.6094"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="1121.291" y="2891.0625"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="3118.8281" width="8" x="1203.9346" y="93.2031"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1207.4346" x2="1207.4346" y1="93.2031" y2="3212.0313"/></g><g><title/><rect fill="#FFFFFF" height="162.0469" style="stroke:#181818;stroke-width:1;" width="10" x="1202.4346" y="2602.1719"/></g><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="34.0249" y="54.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="42.4409" y="71.2041">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="41.0249" y="82.8447">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.6826" x="266.4438" y="54.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="273.4438" y="71.2041">ZETA Attestation Service</text><text fill="#000000" font-family="Helvetica" font-size="10" x="299.9185" y="82.8447">(Admin rights)</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="559.0044" y="66.5625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="566.0044" y="82.8447">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="613.771" y="54.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="620.771" y="71.2041">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="624.7773" y="82.8447">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="735.2793" y="66.5625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="742.2793" y="82.8447">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="809.5088" y="54.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="858.103" y="71.2041">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="816.5088" y="82.8447">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61.7148" x="1095.4336" y="54.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1116.4106" y="71.2041">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1102.4336" y="82.8447">Database</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1167.1484" y="54.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1197.5542" y="71.2041">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1174.1484" y="82.8447">Policy Engine</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="34.0249" y="3212.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="42.4409" y="3228.3135">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="41.0249" y="3239.9541">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.6826" x="266.4438" y="3212.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="273.4438" y="3228.3135">ZETA Attestation Service</text><text fill="#000000" font-family="Helvetica" font-size="10" x="299.9185" y="3239.9541">(Admin rights)</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="559.0044" y="3212.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="566.0044" y="3228.3135">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="613.771" y="3212.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="620.771" y="3228.3135">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="624.7773" y="3239.9541">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="735.2793" y="3212.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="742.2793" y="3228.3135">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="809.5088" y="3212.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="858.103" y="3228.3135">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="816.5088" y="3239.9541">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61.7148" x="1095.4336" y="3212.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1116.4106" y="3228.3135">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1102.4336" y="3239.9541">Database</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1167.1484" y="3212.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1197.5542" y="3228.3135">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1174.1484" y="3239.9541">Policy Engine</text><polygon fill="#181818" points="850.9834,114.8438,860.9834,118.8438,850.9834,122.8438,854.9834,118.8438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="60.5" x2="856.9834" y1="118.8438" y2="118.8438"/><text fill="#000000" font-family="Helvetica" font-size="10" x="67.5" y="114.4854">(01)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="92.0273" y="114.4854">GET /nonce</text><polygon fill="#181818" points="71.5,140.4844,61.5,144.4844,71.5,148.4844,67.5,144.4844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="65.5" x2="861.9834" y1="144.4844" y2="144.4844"/><text fill="#000000" font-family="Helvetica" font-size="10" x="77.5" y="140.126">(02)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="102.0273" y="140.126">return 200 OK new-nonce: nonce</text><path d="M19.3848,156.4844 L79.3408,156.4844 L79.3408,160.125 L69.3408,170.125 L19.3848,170.125 L19.3848,156.4844" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2374.7656" style="stroke:#000000;stroke-width:1.5;" width="1127.9063" x="19.3848" y="156.4844"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="34.3848" y="166.7666">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="94.3408" y="167.7666">[Initial SM(C)-B Token Exchangewith Attestation]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="19.3848" x2="1147.291" y1="2105.1563" y2="2105.1563"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="24.3848" y="2116.4385">[Refresh Token use (without Attestation)]</text><line style="stroke:#181818;stroke-width:1;" x1="60.5" x2="102.5" y1="197.7656" y2="197.7656"/><line style="stroke:#181818;stroke-width:1;" x1="102.5" x2="102.5" y1="197.7656" y2="210.7656"/><line style="stroke:#181818;stroke-width:1;" x1="61.5" x2="102.5" y1="210.7656" y2="210.7656"/><polygon fill="#181818" points="71.5,206.7656,61.5,210.7656,71.5,214.7656,67.5,210.7656" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="67.5" y="193.4072">(03)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="92.0273" y="193.4072">Create DPoP Key Pair (for Token Exchange)</text><path d="M321.2002,185.125 L321.2002,206.125 L547.2002,206.125 L547.2002,195.125 L537.2002,185.125 L321.2002,185.125" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M537.2002,185.125 L537.2002,195.125 L547.2002,195.125 L537.2002,185.125" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="327.2002" y="199.4072">Session-based Key Pair for DPoP binding.</text><line style="stroke:#181818;stroke-width:1;" x1="60.5" x2="102.5" y1="236.4063" y2="236.4063"/><line style="stroke:#181818;stroke-width:1;" x1="102.5" x2="102.5" y1="236.4063" y2="249.4063"/><line style="stroke:#181818;stroke-width:1;" x1="61.5" x2="102.5" y1="249.4063" y2="249.4063"/><polygon fill="#181818" points="71.5,245.4063,61.5,249.4063,71.5,253.4063,67.5,249.4063" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="67.5" y="232.0479">(04)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="92.0273" y="232.0479">Calculate attestation_challenge</text><path d="M261.957,223.7656 L261.957,279.7656 L554.957,279.7656 L554.957,233.7656 L544.957,223.7656 L261.957,223.7656" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M544.957,223.7656 L544.957,233.7656 L554.957,233.7656 L544.957,223.7656" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="267.957" y="238.0479">The attestation_challenge is a cryptographic hash</text><text fill="#000000" font-family="Helvetica" font-size="10" x="267.957" y="249.6885">of the Public Client Instance Key Hash and a nonce.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="267.957" y="261.3291">It is used to bind the attestation to the client instance.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="267.957" y="272.9697">attestation_challenge = HASH(pubKeyHash + nonce)</text><path d="M38.3848,289.3281 L98.3408,289.3281 L98.3408,292.9688 L88.3408,302.9688 L38.3848,302.9688 L38.3848,289.3281" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1141.2031" style="stroke:#000000;stroke-width:1.5;" width="809.0117" x="38.3848" y="289.3281"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="53.3848" y="299.6104">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="113.3408" y="300.6104">[ZETA Attestation Service available]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="38.3848" x2="847.3965" y1="1162.3594" y2="1162.3594"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="43.3848" y="1173.6416">[Fallback: Software-basierte Attestierung]</text><polygon fill="#181818" points="318.7852,338.25,328.7852,342.25,318.7852,346.25,322.7852,342.25" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="60.5" x2="324.7852" y1="342.25" y2="342.25"/><text fill="#000000" font-family="Helvetica" font-size="10" x="67.5" y="332.0713">(05)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="92.0273" y="326.251">Get Attestation</text><text fill="#000000" font-family="Helvetica" font-size="10" x="92.0273" y="337.8916">with `attestation_challenge`</text><path d="M345.7852,317.9688 L345.7852,420.9688 L715.7852,420.9688 L715.7852,327.9688 L705.7852,317.9688 L345.7852,317.9688" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M705.7852,317.9688 L705.7852,327.9688 L715.7852,327.9688 L705.7852,317.9688" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="351.7852" y="332.251">The Prim&#228;rsystem (PS) and the ZETA Attestation Service (ZTA) are</text><text fill="#000000" font-family="Helvetica" font-size="10" x="351.7852" y="343.8916">in the same trust domain. At the time of client installation, the ZTA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="351.7852" y="355.5322">computes a cryptographic hash of the PS software and extends this</text><text fill="#000000" font-family="Helvetica" font-size="10" x="351.7852" y="367.1729">hash into a specific PCR (22 or 23) using TPM2_PCR_Extend. The</text><text fill="#000000" font-family="Helvetica" font-size="10" x="351.7852" y="378.8135">ZTA reads and stores the resulting PCR value as a reference</text><text fill="#000000" font-family="Helvetica" font-size="10" x="351.7852" y="390.4541">measurement or baseline. At every start of the PS, the ZTA measures</text><text fill="#000000" font-family="Helvetica" font-size="10" x="351.7852" y="402.0947">the PS software and extends the resulting hash into the same PCR</text><text fill="#000000" font-family="Helvetica" font-size="10" x="351.7852" y="413.7354">(22 or 23) using TPM2_PCR_Extend.</text><path d="M319.7852,430.0938 L379.7412,430.0938 L379.7412,433.7344 L369.7412,443.7344 L319.7852,443.7344 L319.7852,430.0938" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="199.7656" style="stroke:#000000;stroke-width:1.5;" width="361.5029" x="319.7852" y="430.0938"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="334.7852" y="440.376">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="394.7412" y="441.376">[ZETA TPM Service has no TPM Attestation Key]</text><polygon fill="#181818" points="559.3877,479.0156,569.3877,483.0156,559.3877,487.0156,563.3877,483.0156" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="340.7852" x2="565.3877" y1="483.0156" y2="483.0156"/><text fill="#000000" font-family="Helvetica" font-size="10" x="347.7852" y="472.8369">(06)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="372.3125" y="467.0166">Generate Attestation Key Pair (AK)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="372.3125" y="478.6572">and Get AK Handle</text><polygon fill="#181818" points="351.7852,516.2969,341.7852,520.2969,351.7852,524.2969,347.7852,520.2969" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="345.7852" x2="570.3877" y1="520.2969" y2="520.2969"/><text fill="#000000" font-family="Helvetica" font-size="10" x="357.7852" y="510.1182">(07)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="382.3125" y="504.2979">Return Attestation Public Key</text><text fill="#000000" font-family="Helvetica" font-size="10" x="382.3125" y="515.9385">and AK Handle</text><polygon fill="#181818" points="559.3877,541.9375,569.3877,545.9375,559.3877,549.9375,563.3877,545.9375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="340.7852" x2="565.3877" y1="545.9375" y2="545.9375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="347.7852" y="541.5791">(08)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="372.3125" y="541.5791">Get Certificate Chain</text><polygon fill="#181818" points="351.7852,567.5781,341.7852,571.5781,351.7852,575.5781,347.7852,571.5781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="345.7852" x2="570.3877" y1="571.5781" y2="571.5781"/><text fill="#000000" font-family="Helvetica" font-size="10" x="357.7852" y="567.2197">(09)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="382.3125" y="567.2197">Return Certificate Chain</text><line style="stroke:#181818;stroke-width:1;" x1="340.7852" x2="382.7852" y1="608.8594" y2="608.8594"/><line style="stroke:#181818;stroke-width:1;" x1="382.7852" x2="382.7852" y1="608.8594" y2="621.8594"/><line style="stroke:#181818;stroke-width:1;" x1="341.7852" x2="382.7852" y1="621.8594" y2="621.8594"/><polygon fill="#181818" points="351.7852,617.8594,341.7852,621.8594,351.7852,625.8594,347.7852,621.8594" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="347.7852" y="598.6807">(10)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="372.3125" y="592.8604">Store AK Handle, AK Public Key</text><text fill="#000000" font-family="Helvetica" font-size="10" x="372.3125" y="604.501">and Certificate Chain</text><line style="stroke:#181818;stroke-width:1;" x1="340.7852" x2="382.7852" y1="661.5" y2="661.5"/><line style="stroke:#181818;stroke-width:1;" x1="382.7852" x2="382.7852" y1="661.5" y2="674.5"/><line style="stroke:#181818;stroke-width:1;" x1="341.7852" x2="382.7852" y1="674.5" y2="674.5"/><polygon fill="#181818" points="351.7852,670.5,341.7852,674.5,351.7852,678.5,347.7852,674.5" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="347.7852" y="657.1416">(11)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="372.3125" y="657.1416">Select AK Handle</text><polygon fill="#181818" points="559.3877,742.7031,569.3877,746.7031,559.3877,750.7031,563.3877,746.7031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="340.7852" x2="565.3877" y1="746.7031" y2="746.7031"/><text fill="#000000" font-family="Helvetica" font-size="10" x="347.7852" y="719.0635">(12)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="372.3125" y="695.7822">Get TPM Quote for PCRs</text><text fill="#000000" font-family="Helvetica" font-size="10" x="372.3125" y="707.4229">(4, 5, 7, 10, 11, 22 or 23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="372.3125" y="719.0635">and `attestation_challenge`</text><text fill="#000000" font-family="Helvetica" font-size="10" x="372.3125" y="730.7041">(as qualifyingData),</text><text fill="#000000" font-family="Helvetica" font-size="10" x="372.3125" y="742.3447">signed with AK</text><path d="M59.3848,687.5 L59.3848,731.5 L330.3848,731.5 L330.3848,697.5 L320.3848,687.5 L59.3848,687.5" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M320.3848,687.5 L320.3848,697.5 L330.3848,697.5 L320.3848,687.5" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="65.3848" y="701.7822">Binding: `attestation_challenge` enth&#228;lt Hash des</text><text fill="#000000" font-family="Helvetica" font-size="10" x="65.3848" y="713.4229">Client Instance Public Keys und die Nonce.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="65.3848" y="725.0635">Das TPM signiert PCRs + `attestation_challenge`.</text><path d="M586.3877,687.5 L586.3877,766.5 L826.3877,766.5 L826.3877,697.5 L816.3877,687.5 L586.3877,687.5" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M816.3877,687.5 L816.3877,697.5 L826.3877,697.5 L816.3877,687.5" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="592.3877" y="701.7822">PCR 4: Boot Loader Code, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="592.3877" y="713.4229">PCR 5: Boot Loader Configuration, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="592.3877" y="725.0635">PCR 7: Secure Boot State / Policy, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="592.3877" y="736.7041">PCR   10:OS Kernel / IMA, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="592.3877" y="748.3447">PCR 11: OS Components / VSM, Digest,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="592.3877" y="759.9854">PCR 22 or 23 (if available) App Data, Digest</text><polygon fill="#181818" points="351.7852,785.9844,341.7852,789.9844,351.7852,793.9844,347.7852,789.9844" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="345.7852" x2="570.3877" y1="789.9844" y2="789.9844"/><text fill="#000000" font-family="Helvetica" font-size="10" x="357.7852" y="785.626">(13)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="382.3125" y="785.626">Return TPM Quote</text><line style="stroke:#181818;stroke-width:1;" x1="340.7852" x2="382.7852" y1="815.625" y2="815.625"/><line style="stroke:#181818;stroke-width:1;" x1="382.7852" x2="382.7852" y1="815.625" y2="828.625"/><line style="stroke:#181818;stroke-width:1;" x1="341.7852" x2="382.7852" y1="828.625" y2="828.625"/><polygon fill="#181818" points="351.7852,824.625,341.7852,828.625,351.7852,832.625,347.7852,828.625" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="347.7852" y="811.2666">(14)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="372.3125" y="811.2666">Get TCG Event Log (from OS/Firmware)</text><path d="M581.3877,802.9844 L581.3877,858.9844 L825.3877,858.9844 L825.3877,812.9844 L815.3877,802.9844 L581.3877,802.9844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M815.3877,802.9844 L815.3877,812.9844 L825.3877,812.9844 L815.3877,802.9844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="587.3877" y="817.2666">Quote contains:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="587.3877" y="828.9072">- `attestation_challenge` (as qualifyingData)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="587.3877" y="840.5479">- Attested Data (PCR Select, PCR Digest),</text><text fill="#000000" font-family="Helvetica" font-size="10" x="587.3877" y="852.1885">- Signature</text><polygon fill="#181818" points="71.5,889.8281,61.5,893.8281,71.5,897.8281,67.5,893.8281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="65.5" x2="329.7852" y1="893.8281" y2="893.8281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="77.5" y="883.6494">(15)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="102.0273" y="877.8291">Return Attestation</text><text fill="#000000" font-family="Helvetica" font-size="10" x="102.0273" y="889.4697">(Quote, EventLog, CertChain)</text><line style="stroke:#181818;stroke-width:1;" x1="60.5" x2="102.5" y1="931.1094" y2="931.1094"/><line style="stroke:#181818;stroke-width:1;" x1="102.5" x2="102.5" y1="931.1094" y2="944.1094"/><line style="stroke:#181818;stroke-width:1;" x1="61.5" x2="102.5" y1="944.1094" y2="944.1094"/><polygon fill="#181818" points="71.5,940.1094,61.5,944.1094,71.5,948.1094,67.5,944.1094" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="67.5" y="920.9307">(16)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="92.0273" y="915.1104">Create client_statement</text><text fill="#000000" font-family="Helvetica" font-size="10" x="92.0273" y="926.751">with posture-tpm</text><path d="M224.6035,906.8281 L224.6035,985.8281 L433.6035,985.8281 L433.6035,916.8281 L423.6035,906.8281 L224.6035,906.8281" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M423.6035,906.8281 L423.6035,916.8281 L433.6035,916.8281 L423.6035,906.8281" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="230.6035" y="921.1104">client_statement includes:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="230.6035" y="932.751">- sub</text><text fill="#000000" font-family="Helvetica" font-size="10" x="230.6035" y="944.3916">- product_id</text><text fill="#000000" font-family="Helvetica" font-size="10" x="230.6035" y="956.0322">- product_version</text><text fill="#000000" font-family="Helvetica" font-size="10" x="230.6035" y="967.6729">- posture (containing TPM Quote etc.)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="230.6035" y="979.3135">- attestation-info</text><line style="stroke:#181818;stroke-width:1;" x1="60.5" x2="102.5" y1="1009.3125" y2="1009.3125"/><line style="stroke:#181818;stroke-width:1;" x1="102.5" x2="102.5" y1="1009.3125" y2="1022.3125"/><line style="stroke:#181818;stroke-width:1;" x1="61.5" x2="102.5" y1="1022.3125" y2="1022.3125"/><polygon fill="#181818" points="71.5,1018.3125,61.5,1022.3125,71.5,1026.3125,67.5,1022.3125" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="67.5" y="1004.9541">(17)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="92.0273" y="1004.9541">Create Client Assertion JWT</text><path d="M241.5859,996.6719 L241.5859,1145.6719 L543.5859,1145.6719 L543.5859,1006.6719 L533.5859,996.6719 L241.5859,996.6719" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M533.5859,996.6719 L533.5859,1006.6719 L543.5859,1006.6719 L533.5859,996.6719" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="247.5859" y="1010.9541">Client Assertion JWT Claims (with Attestation):</text><text fill="#000000" font-family="Helvetica" font-size="10" x="247.5859" y="1022.5947">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="253.9434" y="1034.2354">"iss": "&lt;client_id&gt;", "sub": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="253.9434" y="1045.876">"aud": "&lt;AS_Token_Endpoint_URL&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="253.9434" y="1057.5166">"exp": ..., "jti": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="253.9434" y="1069.1572">// Embed the client_statement with attestation</text><text fill="#000000" font-family="Helvetica" font-size="10" x="253.9434" y="1080.7979">"urn:gematik:params:oauth:client-attestation:tpm2": {</text><text fill="#000000" font-family="Helvetica" font-size="10" x="263.4795" y="1092.4385">"attestation_data": "&lt;Base64(client_statement)&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="263.4795" y="1104.0791">"client_statement_format": "client-statement"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="257.1221" y="1115.7197">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="247.5859" y="1127.3604">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="247.5859" y="1139.001">(sig by Client_Instance_Private_Key)</text><line style="stroke:#181818;stroke-width:1;" x1="60.5" x2="102.5" y1="1210.2813" y2="1210.2813"/><line style="stroke:#181818;stroke-width:1;" x1="102.5" x2="102.5" y1="1210.2813" y2="1223.2813"/><line style="stroke:#181818;stroke-width:1;" x1="61.5" x2="102.5" y1="1223.2813" y2="1223.2813"/><polygon fill="#181818" points="71.5,1219.2813,61.5,1223.2813,71.5,1227.2813,67.5,1223.2813" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="67.5" y="1200.1025">(18)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="92.0273" y="1194.2822">Create client_statement</text><text fill="#000000" font-family="Helvetica" font-size="10" x="92.0273" y="1205.9229">with posture-software</text><path d="M224.6035,1186 L224.6035,1265 L486.6035,1265 L486.6035,1196 L476.6035,1186 L224.6035,1186" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M476.6035,1186 L476.6035,1196 L486.6035,1196 L476.6035,1186" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="230.6035" y="1200.2822">client_statement includes:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="230.6035" y="1211.9229">- sub</text><text fill="#000000" font-family="Helvetica" font-size="10" x="230.6035" y="1223.5635">- product_id</text><text fill="#000000" font-family="Helvetica" font-size="10" x="230.6035" y="1235.2041">- product_version</text><text fill="#000000" font-family="Helvetica" font-size="10" x="230.6035" y="1246.8447">- posture (containing attestation_challenge etc.)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="230.6035" y="1258.4854">- attestation-info</text><line style="stroke:#181818;stroke-width:1;" x1="60.5" x2="102.5" y1="1288.4844" y2="1288.4844"/><line style="stroke:#181818;stroke-width:1;" x1="102.5" x2="102.5" y1="1288.4844" y2="1301.4844"/><line style="stroke:#181818;stroke-width:1;" x1="61.5" x2="102.5" y1="1301.4844" y2="1301.4844"/><polygon fill="#181818" points="71.5,1297.4844,61.5,1301.4844,71.5,1305.4844,67.5,1301.4844" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="67.5" y="1284.126">(19)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="92.0273" y="1284.126">Create Client Assertion JWT</text><path d="M241.5859,1275.8438 L241.5859,1424.8438 L560.5859,1424.8438 L560.5859,1285.8438 L550.5859,1275.8438 L241.5859,1275.8438" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M550.5859,1275.8438 L550.5859,1285.8438 L560.5859,1285.8438 L550.5859,1275.8438" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="247.5859" y="1290.126">Client Assertion JWT Claims (with Attestation):</text><text fill="#000000" font-family="Helvetica" font-size="10" x="247.5859" y="1301.7666">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="253.9434" y="1313.4072">"iss": "&lt;client_id&gt;", "sub": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="253.9434" y="1325.0479">"aud": "&lt;AS_Token_Endpoint_URL&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="253.9434" y="1336.6885">"exp": ..., "jti": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="253.9434" y="1348.3291">// Embed the client_statement</text><text fill="#000000" font-family="Helvetica" font-size="10" x="253.9434" y="1359.9697">"urn:gematik:params:oauth:client-attestation:software": {</text><text fill="#000000" font-family="Helvetica" font-size="10" x="263.4795" y="1371.6104">"attestation_data": "&lt;Base64(client_statement)&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="263.4795" y="1383.251">"client_statement_format": "client-statement"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="257.1221" y="1394.8916">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="247.5859" y="1406.5322">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="247.5859" y="1418.1729">(sig by Client_Instance_Private_Key)</text><line style="stroke:#181818;stroke-width:1;" x1="60.5" x2="102.5" y1="1462.1719" y2="1462.1719"/><line style="stroke:#181818;stroke-width:1;" x1="102.5" x2="102.5" y1="1462.1719" y2="1475.1719"/><line style="stroke:#181818;stroke-width:1;" x1="61.5" x2="102.5" y1="1475.1719" y2="1475.1719"/><polygon fill="#181818" points="71.5,1471.1719,61.5,1475.1719,71.5,1479.1719,67.5,1475.1719" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="67.5" y="1457.8135">(20)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="92.0273" y="1457.8135">Create "SM(C)-B ID Token" (JWT)</text><path d="M267.5234,1449.5313 L267.5234,1575.5313 L700.5234,1575.5313 L700.5234,1459.5313 L690.5234,1449.5313 L267.5234,1449.5313" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M690.5234,1449.5313 L690.5234,1459.5313 L700.5234,1459.5313 L690.5234,1449.5313" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="273.5234" y="1463.8135">SM(C)-B ID Token Claims:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="273.5234" y="1475.4541">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="279.8809" y="1487.0947">"iss": "&lt;client_id&gt;", // Issuer is the client</text><text fill="#000000" font-family="Helvetica" font-size="10" x="279.8809" y="1498.7354">"nonce": "&lt;nonce from AS&gt;", // Binding to AS</text><text fill="#000000" font-family="Helvetica" font-size="10" x="279.8809" y="1510.376">"sub": "&lt;Telematik-ID from SM(C)-B&gt;", // Subject is the institution</text><text fill="#000000" font-family="Helvetica" font-size="10" x="279.8809" y="1522.0166">"aud": "[&lt;Resource_Server_Endpoint_URL&gt;]", // Audience is the Resource Server</text><text fill="#000000" font-family="Helvetica" font-size="10" x="279.8809" y="1533.6572">"exp": ..., // Short-lived</text><text fill="#000000" font-family="Helvetica" font-size="10" x="279.8809" y="1545.2979">"iat": ...,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="279.8809" y="1556.9385">"jti": "..."</text><text fill="#000000" font-family="Helvetica" font-size="10" x="273.5234" y="1568.5791">}</text><polygon fill="#181818" points="636.1978,1594.5781,646.1978,1598.5781,636.1978,1602.5781,640.1978,1598.5781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="60.5" x2="642.1978" y1="1598.5781" y2="1598.5781"/><text fill="#000000" font-family="Helvetica" font-size="10" x="67.5" y="1594.2197">(21)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="92.0273" y="1594.2197">externalAuthenticate (JWT-hash)</text><polygon fill="#181818" points="745.394,1620.2188,755.394,1624.2188,745.394,1628.2188,749.394,1624.2188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="658.1978" x2="751.394" y1="1624.2188" y2="1624.2188"/><text fill="#000000" font-family="Helvetica" font-size="10" x="665.1978" y="1619.8604">(22)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="689.7251" y="1619.8604">sign (hash)</text><polygon fill="#181818" points="669.1978,1645.8594,659.1978,1649.8594,669.1978,1653.8594,665.1978,1649.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="663.1978" x2="756.394" y1="1649.8594" y2="1649.8594"/><text fill="#000000" font-family="Helvetica" font-size="10" x="675.1978" y="1645.501">(23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="699.7251" y="1645.501">Signature</text><polygon fill="#181818" points="71.5,1671.5,61.5,1675.5,71.5,1679.5,67.5,1675.5" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="65.5" x2="647.1978" y1="1675.5" y2="1675.5"/><text fill="#000000" font-family="Helvetica" font-size="10" x="77.5" y="1671.1416">(24)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="102.0273" y="1671.1416">JWT-signature</text><line style="stroke:#181818;stroke-width:1;" x1="60.5" x2="102.5" y1="1701.1406" y2="1701.1406"/><line style="stroke:#181818;stroke-width:1;" x1="102.5" x2="102.5" y1="1701.1406" y2="1714.1406"/><line style="stroke:#181818;stroke-width:1;" x1="61.5" x2="102.5" y1="1714.1406" y2="1714.1406"/><polygon fill="#181818" points="71.5,1710.1406,61.5,1714.1406,71.5,1718.1406,67.5,1714.1406" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="67.5" y="1696.7822">(25)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="92.0273" y="1696.7822">Add JWT-Signature to SM(C)-B ID Token</text><line style="stroke:#181818;stroke-width:1;" x1="60.5" x2="102.5" y1="1739.7813" y2="1739.7813"/><line style="stroke:#181818;stroke-width:1;" x1="102.5" x2="102.5" y1="1739.7813" y2="1752.7813"/><line style="stroke:#181818;stroke-width:1;" x1="61.5" x2="102.5" y1="1752.7813" y2="1752.7813"/><polygon fill="#181818" points="71.5,1748.7813,61.5,1752.7813,71.5,1756.7813,67.5,1752.7813" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="67.5" y="1735.4229">(26)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="92.0273" y="1735.4229">Create DPoP Proof JWT for Token Exchange</text><path d="M320.5654,1727.1406 L320.5654,1876.1406 L598.5654,1876.1406 L598.5654,1737.1406 L588.5654,1727.1406 L320.5654,1727.1406" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M588.5654,1727.1406 L588.5654,1737.1406 L598.5654,1737.1406 L588.5654,1727.1406" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="326.5654" y="1741.4229">DPoP Proof JWT Claims (for Token Exchange):</text><text fill="#000000" font-family="Helvetica" font-size="10" x="326.5654" y="1753.0635">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.9229" y="1764.7041">"typ": "dpop+jwt",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.9229" y="1776.3447">"alg": "ES256",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.9229" y="1787.9854">"jwk": { ... }</text><text fill="#000000" font-family="Helvetica" font-size="10" x="326.5654" y="1799.626">}.{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.9229" y="1811.2666">"jti": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.9229" y="1822.9072">"htm": "POST",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.9229" y="1834.5479">"htu": "&lt;AS_Token_Endpoint_URL&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.9229" y="1846.1885">"nonce": "&lt;nonce from AS&gt;", // Binding to AS</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.9229" y="1857.8291">"iat": ...</text><text fill="#000000" font-family="Helvetica" font-size="10" x="326.5654" y="1869.4697">}.(sig by DPoP_Private_Key)</text><polygon fill="#181818" points="850.9834,1895.4688,860.9834,1899.4688,850.9834,1903.4688,854.9834,1899.4688" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="60.5" x2="856.9834" y1="1899.4688" y2="1899.4688"/><text fill="#000000" font-family="Helvetica" font-size="10" x="67.5" y="1895.1104">(27)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="92.0273" y="1895.1104">POST /token (RFC 8693) DPoP: &lt;signed_dpop_jwt&gt;</text><path d="M65.5,1912.4688 L65.5,2026.4688 L478.5,2026.4688 L478.5,1922.4688 L468.5,1912.4688 L65.5,1912.4688" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M468.5,1912.4688 L468.5,1922.4688 L478.5,1922.4688 L468.5,1912.4688" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="71.5" y="1926.751">Token Exchange Request Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="71.5" y="1938.3916">grant_type=urn:ietf:params:oauth:grant-type:token-exchange</text><text fill="#000000" font-family="Helvetica" font-size="10" x="71.5" y="1950.0322">&amp;subject_token=&lt;SM(C)-B signed ID Token&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="71.5" y="1961.6729">&amp;subject_token_type=urn:ietf:params:oauth:token-type:jwt</text><text fill="#000000" font-family="Helvetica" font-size="10" x="71.5" y="1973.3135">&amp;client_assertion_type=urn:ietf:params:oauth:client-assertion-type:jwt-bearer</text><text fill="#000000" font-family="Helvetica" font-size="10" x="71.5" y="1984.9541">&amp;client_assertion=&lt;Client_Assertion_JWT&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="71.5" y="1996.5947">&amp;audience=&lt;Resource Server Endpoint&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="71.5" y="2008.2354">&amp;scope=&lt;Resource Server scopes&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="71.5" y="2019.876">...</text><line style="stroke:#181818;stroke-width:1;" x1="872.9834" x2="914.9834" y1="2073.1563" y2="2073.1563"/><line style="stroke:#181818;stroke-width:1;" x1="914.9834" x2="914.9834" y1="2073.1563" y2="2086.1563"/><line style="stroke:#181818;stroke-width:1;" x1="873.9834" x2="914.9834" y1="2086.1563" y2="2086.1563"/><polygon fill="#181818" points="883.9834,2082.1563,873.9834,2086.1563,883.9834,2090.1563,879.9834,2086.1563" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="879.9834" y="2057.1572">(28)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="904.5107" y="2045.5166">Validate Request (Client Assertion,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="904.5107" y="2057.1572">Attestation, DPoP Proof,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="904.5107" y="2068.7979">Subject Token)</text><line style="stroke:#181818;stroke-width:1;" x1="60.5" x2="102.5" y1="2141.4375" y2="2141.4375"/><line style="stroke:#181818;stroke-width:1;" x1="102.5" x2="102.5" y1="2141.4375" y2="2154.4375"/><line style="stroke:#181818;stroke-width:1;" x1="61.5" x2="102.5" y1="2154.4375" y2="2154.4375"/><polygon fill="#181818" points="71.5,2150.4375,61.5,2154.4375,71.5,2158.4375,67.5,2154.4375" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="67.5" y="2137.0791">(29)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="92.0273" y="2137.0791">Create Client Assertion JWT without Attestation</text><path d="M340.7852,2128.7969 L340.7852,2242.7969 L643.7852,2242.7969 L643.7852,2138.7969 L633.7852,2128.7969 L340.7852,2128.7969" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M633.7852,2128.7969 L633.7852,2138.7969 L643.7852,2138.7969 L633.7852,2128.7969" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="346.7852" y="2143.0791">Client Assertion JWT Claims (without Attestation):</text><text fill="#000000" font-family="Helvetica" font-size="10" x="346.7852" y="2154.7197">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="353.1426" y="2166.3604">"iss": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="353.1426" y="2178.001">"sub": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="353.1426" y="2189.6416">"aud": "&lt;AS_Token_Endpoint_URL&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="353.1426" y="2201.2822">"exp": ...,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="353.1426" y="2212.9229">"jti": "..."</text><text fill="#000000" font-family="Helvetica" font-size="10" x="346.7852" y="2224.5635">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="346.7852" y="2236.2041">(sig by Client_Instance_Private_Key)</text><line style="stroke:#181818;stroke-width:1;" x1="60.5" x2="102.5" y1="2266.2031" y2="2266.2031"/><line style="stroke:#181818;stroke-width:1;" x1="102.5" x2="102.5" y1="2266.2031" y2="2279.2031"/><line style="stroke:#181818;stroke-width:1;" x1="61.5" x2="102.5" y1="2279.2031" y2="2279.2031"/><polygon fill="#181818" points="71.5,2275.2031,61.5,2279.2031,71.5,2283.2031,67.5,2279.2031" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="67.5" y="2261.8447">(30)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="92.0273" y="2261.8447">Create DPoP Proof JWT for Token Exchange</text><polygon fill="#181818" points="850.9834,2300.8438,860.9834,2304.8438,850.9834,2308.8438,854.9834,2304.8438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="60.5" x2="856.9834" y1="2304.8438" y2="2304.8438"/><text fill="#000000" font-family="Helvetica" font-size="10" x="67.5" y="2300.4854">(31)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="92.0273" y="2300.4854">POST /token DPoP: &lt;signed_dpop_jwt&gt;</text><path d="M65.5,2317.8438 L65.5,2385.8438 L478.5,2385.8438 L478.5,2327.8438 L468.5,2317.8438 L65.5,2317.8438" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M468.5,2317.8438 L468.5,2327.8438 L478.5,2327.8438 L468.5,2317.8438" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="71.5" y="2332.126">Token Exchange Request Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="71.5" y="2343.7666">grant_type=refresh_token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="71.5" y="2355.4072">&amp;refresh_token=&lt;Refresh_Token&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="71.5" y="2367.0479">&amp;client_assertion_type=urn:ietf:params:oauth:client-assertion-type:jwt-bearer</text><text fill="#000000" font-family="Helvetica" font-size="10" x="71.5" y="2378.6885">&amp;client_assertion=&lt;Client_Assertion_JWT_</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="284.0635" y="2378.6885">without</text><text fill="#000000" font-family="Helvetica" font-size="10" x="327.3984" y="2378.6885">_Attestation&gt;</text><line style="stroke:#181818;stroke-width:1;" x1="872.9834" x2="914.9834" y1="2420.3281" y2="2420.3281"/><line style="stroke:#181818;stroke-width:1;" x1="914.9834" x2="914.9834" y1="2420.3281" y2="2433.3281"/><line style="stroke:#181818;stroke-width:1;" x1="873.9834" x2="914.9834" y1="2433.3281" y2="2433.3281"/><polygon fill="#181818" points="883.9834,2429.3281,873.9834,2433.3281,883.9834,2437.3281,879.9834,2433.3281" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="879.9834" y="2410.1494">(32)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="904.5107" y="2404.3291">Validate Request (Client Assertion,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="904.5107" y="2415.9697">DPoP Proof, Refresh Token)</text><line style="stroke:#181818;stroke-width:1;" x1="872.9834" x2="914.9834" y1="2458.9688" y2="2458.9688"/><line style="stroke:#181818;stroke-width:1;" x1="914.9834" x2="914.9834" y1="2458.9688" y2="2471.9688"/><line style="stroke:#181818;stroke-width:1;" x1="873.9834" x2="914.9834" y1="2471.9688" y2="2471.9688"/><polygon fill="#181818" points="883.9834,2467.9688,873.9834,2471.9688,883.9834,2475.9688,879.9834,2471.9688" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="879.9834" y="2454.6104">(33)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="904.5107" y="2454.6104">Invalidate Refresh token</text><polygon fill="#181818" points="1109.291,2493.6094,1119.291,2497.6094,1109.291,2501.6094,1113.291,2497.6094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="872.9834" x2="1115.291" y1="2497.6094" y2="2497.6094"/><text fill="#000000" font-family="Helvetica" font-size="10" x="879.9834" y="2493.251">(34)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="904.5107" y="2493.251">Get Client Data, Session Data, User Data</text><polygon fill="#181818" points="883.9834,2519.25,873.9834,2523.25,883.9834,2527.25,879.9834,2523.25" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="877.9834" x2="1120.291" y1="2523.25" y2="2523.25"/><text fill="#000000" font-family="Helvetica" font-size="10" x="889.9834" y="2518.8916">(35)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="914.5107" y="2518.8916">Client Data, Session Data, User Data</text><path d="M20.5,2549.25 L80.4561,2549.25 L80.4561,2552.8906 L70.4561,2562.8906 L20.5,2562.8906 L20.5,2549.25" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="638.7813" style="stroke:#000000;stroke-width:1.5;" width="1207.9346" x="20.5" y="2549.25"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="35.5" y="2559.5322">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="95.4561" y="2560.5322">[Validations Successful]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="20.5" x2="1228.4346" y1="3143.75" y2="3143.75"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="25.5" y="3155.0322">[Validation Failed]</text><polygon fill="#181818" points="1190.4346,2598.1719,1200.4346,2602.1719,1190.4346,2606.1719,1194.4346,2602.1719" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="872.9834" x2="1196.4346" y1="2602.1719" y2="2602.1719"/><text fill="#000000" font-family="Helvetica" font-size="10" x="879.9834" y="2591.9932">(36)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="904.5107" y="2586.1729">POST /v1/data/authz, body</text><text fill="#000000" font-family="Helvetica" font-size="10" x="904.5107" y="2597.8135">{  "input": {...}}</text><path d="M1012.5674,2615.1719 L1012.5674,2741.1719 L1201.5674,2741.1719 L1201.5674,2625.1719 L1191.5674,2615.1719 L1012.5674,2615.1719" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><path d="M1191.5674,2615.1719 L1191.5674,2625.1719 L1201.5674,2625.1719 L1191.5674,2615.1719" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1018.5674" y="2629.4541">Policy Engine Response Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1018.5674" y="2641.0947">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1024.9248" y="2652.7354">...</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1024.9248" y="2664.376">"allow": true,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1024.9248" y="2676.0166">"ttl": {</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1031.2822" y="2687.6572">"access_token": 300,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1031.2822" y="2699.2979">"refresh_token": 86400</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1024.9248" y="2710.9385">},</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1024.9248" y="2722.5791">...</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1018.5674" y="2734.2197">}</text><polygon fill="#181818" points="883.9834,2760.2188,873.9834,2764.2188,883.9834,2768.2188,879.9834,2764.2188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="877.9834" x2="1201.4346" y1="2764.2188" y2="2764.2188"/><text fill="#000000" font-family="Helvetica" font-size="10" x="889.9834" y="2759.8604">(37)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="914.5107" y="2759.8604">200 OK</text><path d="M39.5,2776.2188 L99.4561,2776.2188 L99.4561,2779.8594 L89.4561,2789.8594 L39.5,2789.8594 L39.5,2776.2188" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="342.5313" style="stroke:#000000;stroke-width:1.5;" width="1107.791" x="39.5" y="2776.2188"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="54.5" y="2786.501">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="114.4561" y="2787.501">[Policy Decision allowed]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="39.5" x2="1147.291" y1="3074.4688" y2="3074.4688"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="44.5" y="3085.751">[Policy Decision denied]</text><line style="stroke:#181818;stroke-width:1;" x1="872.9834" x2="914.9834" y1="2829.1406" y2="2829.1406"/><line style="stroke:#181818;stroke-width:1;" x1="914.9834" x2="914.9834" y1="2829.1406" y2="2842.1406"/><line style="stroke:#181818;stroke-width:1;" x1="873.9834" x2="914.9834" y1="2842.1406" y2="2842.1406"/><polygon fill="#181818" points="883.9834,2838.1406,873.9834,2842.1406,883.9834,2846.1406,879.9834,2842.1406" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="879.9834" y="2818.9619">(38)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="904.5107" y="2813.1416">Generate AS Access Token (AT)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="904.5107" y="2824.7822">and Refresh Token (RT)</text><polygon fill="#181818" points="1109.291,2887.0625,1119.291,2891.0625,1109.291,2895.0625,1113.291,2891.0625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="872.9834" x2="1115.291" y1="2891.0625" y2="2891.0625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="879.9834" y="2875.0635">(39)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="904.5107" y="2863.4229">Update Client Data</text><text fill="#000000" font-family="Helvetica" font-size="10" x="904.5107" y="2875.0635">Update Session</text><text fill="#000000" font-family="Helvetica" font-size="10" x="904.5107" y="2886.7041">Update User Data</text><polygon fill="#181818" points="883.9834,2912.7031,873.9834,2916.7031,883.9834,2920.7031,879.9834,2916.7031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="877.9834" x2="1120.291" y1="2916.7031" y2="2916.7031"/><text fill="#000000" font-family="Helvetica" font-size="10" x="889.9834" y="2912.3447">(40)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="914.5107" y="2912.3447">updated</text><polygon fill="#181818" points="71.5,2938.3438,61.5,2942.3438,71.5,2946.3438,67.5,2942.3438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="65.5" x2="861.9834" y1="2942.3438" y2="2942.3438"/><text fill="#000000" font-family="Helvetica" font-size="10" x="77.5" y="2937.9854">(41)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="102.0273" y="2937.9854">200 OK, new tokens</text><path d="M587.0127,2955.3438 L587.0127,3058.3438 L862.0127,3058.3438 L862.0127,2965.3438 L852.0127,2955.3438 L587.0127,2955.3438" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><path d="M852.0127,2955.3438 L852.0127,2965.3438 L862.0127,2965.3438 L852.0127,2955.3438" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="593.0127" y="2969.626">Token Response Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="593.0127" y="2981.2666">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="599.3701" y="2992.9072">"access_token": "&lt;AS_Access_Token&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="599.3701" y="3004.5479">"token_type": "DPoP", // Indicate DPoP is required</text><text fill="#000000" font-family="Helvetica" font-size="10" x="599.3701" y="3016.1885">"expires_in": 300,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="599.3701" y="3027.8291">"refresh_token": "&lt;AS_Refresh_Token&gt;"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="599.3701" y="3039.4697">// ... other parameters</text><text fill="#000000" font-family="Helvetica" font-size="10" x="593.0127" y="3051.1104">}</text><polygon fill="#181818" points="71.5,3106.75,61.5,3110.75,71.5,3114.75,67.5,3110.75" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="65.5" x2="861.9834" y1="3110.75" y2="3110.75"/><text fill="#000000" font-family="Helvetica" font-size="10" x="77.5" y="3106.3916">(42)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="102.0273" y="3106.3916">403 Forbidden</text><polygon fill="#181818" points="71.5,3176.0313,61.5,3180.0313,71.5,3184.0313,67.5,3180.0313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="65.5" x2="861.9834" y1="3180.0313" y2="3180.0313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="77.5" y="3175.6729">(43)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="102.0273" y="3175.6729">400 Bad Request</text><!--SRC=[xLhzSjl64VyVJx5bPXgI9YHP_aZAiJn3KPIiIfPOaKdQb1tcI1p9iy433Hmaonw_JTuaBzRTkmDm047BIPjsfjEPP0G2ktlxyTlVxG5cgOfakfxn61hDWuDMmqlU2hbXCLj3m1Si3TLf9DL8VE3m-A3-uHLRStZ5mrkkn9mvCYT6vdKaesJ3vZp8fVjH6WiUEx8XbqkrwWLlqaI1Z2HtdYNyNShbdD_m1O_fufZDtoxZA9L1FmgZ67vO2UKgZAeAHGo7tlxN3mcg-v33B0e3x-jzp_l39cRBDGF5em-WufHxtYnw3utBmNa3lZfRHOaowmFe-yDOh7_vEKxk4yNNA779RhaCC5W0A_7ZODo3VYYuLFXyn6HmVnn7Tr9B0A1hc4YnOL9PAM29qPf8gwP5qImPzAfAF_P6kGRqbEA9Oaf44iEDRyMSJsIp5wo5X5WiLoffDROiZ8UljGNyIm-BXLoXYqXA_bPX_acq-1N54pa-zy-OudVilb7H6hq-rlAZryr-opzkU9bnazMUd0ckU8o96G_whwwkBw_F_kQvYJjBMHnivyrTevUgbKd1y6GuaVGpYiM78WbeVqi9HK-E2wKJfjYC9Rn6S5183QDGpEzX89T2SZTLULIsWeyUPLV-I-lVeqVGXRF16FOHxtFkcRi-Fiya_Ix4NAMnXCE30xY-0CdlV2tS1QFZVGr7HqSm6lTknbqONryChc3mr_whtjNP04Q3_lZy-eeaF1OgE9T22HQ2JJsCexTSmk3zVCNaajy9jNBHWi4K7jkhBlHZZdM5as4qX0j-3qCcOcWkiEnbQorKbn5AQenrCUj9WaPzIcbGQ9AYjZKJCX1okUVLB8khid2UXhGmAnoSuaeXyGQlh3LUxP03aG23UNo_KT4oPfkLcCEA9Qk9Z1QWK6kOph2UcGFd4YrWbhMxhr0E479eGAT-RoBF5HbCAI0LwGYq4MTfka-tviQWi0PHjzw_8tZL6xrgRj8PBgbNV6HMetJYVwLgzyRZ0Lxg4hkb1g1Yxsf-OBTCX6mMSWti8jV46WQINBcA4wcHyLEjnpzf8_bwn1lPEfXOz5tVSjt0m2pFLKjM8ave3aSjdM_AtyvWcZ-EUoWM8wSXdv5eGliBqZHk8q6qPaBkeQ9-eWG-mKAxnGX3RQzZLY62dKVhJOeBrG85CfoC88aMwWuNrZxozmeRFi5d8fb8BIaarfv1ik5piK3rOVy6ceU7o8vm-AI5g46qKt8Ef_XaEj06zYWF4ub-ODypj4Us4-HKdkXbyI_kfwH8rcvPc7AY8eOFxFuraMlEaZJcQmeHrw9-2v6RT1Ou4jyz6aGoAoB9OmUhYX5yFaRNaIBMFFde6-um3uLgGK2eG_0HIYpu98-fqIkOiKJJksXXxw0t6gGNs9Koi4W6RSGtIEx2ZI5ErupjRhHcR5Jr2rzC4_GvaZxMZjpfhn1AdrbdbworgKL7LCbYrGvTLdsgjqEx2JQPvssPv26VLpDHZOFy_KjAtKPqYpN02ZUVTk1P1xxfu5Y7_p_kG5umuyYEVaTDHDoxb8LYSOzrfMsorPd8H2mbyg3PH2wylBz3li3sFZRitjrb5GDKgrz-HXhHf1SG1giaN6GAEHST30I7Ayl49-WJHKbUu5ofT938dJkMs_Eg_4Fzz1JzZ285bn73SGrdr01BT2AMQ00tUXHuLXMG2x5COyiWhkGtL9avzf9H62agvpwOQQ4i2bY0xlK8uueb3r7e_7MlBF7uSHTGe8_4X7EnL0aAVJzwdGbrZ5HMFcYAHS7nBUXjDa15oiIz2eBrb651d0Db2sSQHlqp6DnIJIwZ9UxvSRH6l_PFHRmcacXj9TLWReuZDU8uwKwalxF-DQ0YSTEzY2kwWri2ncaGtz4LCn4H_7mOOUaPHk7uNfwajWa1iQnTx9YmCAgExZ_TTwtAzfYF8cO0Cfl8b2nfhhMxv0PF0-Y3hpRhhNHKLP0svs6AMDUPIT8P_Td4KP3ErLG4xY_axKGxx6ShGDFcrNAhJJPNypsTEIVFlf2Bg3QQOfwpltj9Glo3NFdd7yQL0E2haFxCSDEnt0RGRjSfeZKcrWaqgoDbgzjkvxeVyok0XaYIHXSQBsoEHF2oqO46vcJhhgl5qa0_xuscUlgS3cImYN0tcdvtSrcHvUytABktjuTstoX1UlYZ9BE_3mCy2WVEoEPKImV3IlDnRXo1rLtoDTv_szKdowGRCHpdkyQAxwXr4Hg7kBeRlex5QOm0qQu3EyRT-_dJPjMNLZasKg-AJ97gqH-oOdt87pLSrK_UzbKJQHHcznOKquo1fpYWtQADAL9mAz-MfA4B7YOSJh6VPtWsH_QpamFD-qJ8sNwErwbS_akjbGqb_y7-gX_M_zzhlrUl_TRMog3nFzXUTW3CZe23gvFT1y3gGJ4xxv-Vs4Ew1Y81o1mNTqErKLLjG1D1LpxSRuErtTvUKiEqm6HHdtey8ZxEaoJ5CKia3aOABNqirdhw2lGuqXjPNJjmqlcxDogKCf2FSOZGaFBHGQrf7RRgetJsXkPgkpOT5OLAIwoVDSJVNzpm94fZBA1virHkZ7yOWxqKnrLoqrhCTEpRAA-kTSYFLHGhFnItF73ofN578iKzfyky0cyvW4f5BjxKwHCNdUjYoK9w_OGIvkX1LVRfR4UbBXHGczxVQJsQjQ6PoT1jlsJSzr78dShSHyvaXbAqME98rW2o5mHQB3T8fQsYp7ludTKmZl3aIyIv_SxgGLHNB6JKM_FsgnRewfvgsq1qR1wzkLCEoJHOkAH7Wz7Xi-Vk_JTtRudCgDevWtpQ-rXRU4TjfTPqTtWz6fTlfr_6uR-jkt9WvevcL4U9g_ARmsuEftsUgqhrTTwYKg2mhxH2y-Qq3zy-_zEJbbws2o_CsNHAUPzYtbzMDriifxLQgNcxNIuhjksx5BSHFDK5zrc9bp73169j-H7jLOAhHNcZqW8-2NIrXpuly0RmnyHmpLG_EtgH9S0UgBCylAmH_joYPYMzA8Pib2t1icn- -9n-jhjcihafVyPnXuthBHwzi9jQFgDCiL6ixynouD6B2lj11iCio7cqgP7IjnCZau7C0P5zVPxXeWlVut4oeCRFgjQi3b1uS7Gcfex34FWasmDq-bkUfoVS6xw8URAos4pnZXwyehJqohJb_Thv3sgiF4X73yw3LRU-UFlTtZ7hdtxnKEZiQmzjMhzYHAhVttuzxs_JIfbITlF8xy4YiS6OwN7J4QLRr1dcfyiC_wtcdhRR5chjzjG1sqlltz2TJaEMMw-rPR8Bv_Asi6bainJcekOZN_wPmovfte_PJrJsrtVeXRv4TQFbvzxJwwGlKit6TcU3-ymtEXHpn_RlUvVd9zlJFNriiSd39HESLUTpN7wHXgL01-xEUFjudmuz-rJz3nsO8V0cyYCrlzoaj6b_n2RyzAdysfOGZMOCcfSnjs1ijqiVFMcKtQ0Vl0JdZ5-AOG17d32wmwNe4tf60Wsbmj9XhS5qC0Re-EJ9mO536AKsmAVVFdzwS91HHwUovAVg1e6nb4jeFghQxsKsg1C-5xgKsbqxTc-1j_XACOAUzjXIIhCtjk_Fopj5ysRSAfjoaFZT9d3s1GBEHDfx5bZvRnULzRXCjM39R-SLYmcvGn-IJNCaUNPBTJUQrTAxR5PRzgrt3PLowft29CoIL_d5GJ7Ma31rlpqAuhmvpxaSpr0naeQ8dLEHsMBmLZ8LMy2fWOxsfCoZZVBh2Hgv8pmInQ2va_vHGb8vpLVVVrKn570fTfRYwS4JE8tYcGW2dTwCAxIbei7Xb8bG6wdvzm50PWxWc0KPZTPHpWuYoVz1WlzF]--></g></svg>