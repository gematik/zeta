<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="3204px" preserveAspectRatio="none" style="width:1286px;height:3204px;background:#FFFFFF;" version="1.1" viewBox="0 0 1286 3204" width="1286px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="3192.2656" style="stroke:#181818;stroke-width:0.5;" width="782.5088" x="39.793" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="422.5854" y="15.2822">LEI</text><rect fill="#E6E6FA" height="3175.625" style="stroke:#181818;stroke-width:0.5;" width="586.771" x="39.793" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="294.0818" y="31.9229">Prim&#228;rsystem</text><rect fill="#F4A460" height="3158.9844" style="stroke:#181818;stroke-width:0.5;" width="89" x="39.793" y="39.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="51.793" y="48.5635">ZETA Client</text><rect fill="#C9FFC9" height="3192.2656" style="stroke:#181818;stroke-width:0.5;" width="446.2119" x="834.3018" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1033.0474" y="15.2822">Anbieter</text><rect fill="#F4A460" height="3175.625" style="stroke:#181818;stroke-width:0.5;" width="446.2119" x="834.3018" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1024.2632" y="31.9229">ZETA Guard</text><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="2994.0625" width="8" x="15.8965" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="19.3965" x2="19.3965" y1="126.5625" y2="3120.625"/></g><g><title>ZETA</title><rect fill="#000000" fill-opacity="0.00000" height="2994.0625" width="8" x="80.793" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="84.293" x2="84.293" y1="126.5625" y2="3120.625"/></g><g><title/><rect fill="#FFFFFF" height="2981.0625" style="stroke:#181818;stroke-width:1;" width="10" x="79.293" y="134.5625"/></g><g><title>ZETA Attestation Service</title><rect fill="#000000" fill-opacity="0.00000" height="2994.0625" width="8" x="361.0781" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="364.5781" x2="364.5781" y1="126.5625" y2="3120.625"/></g><g><title/><rect fill="#FFFFFF" height="551.5781" style="stroke:#181818;stroke-width:1;" width="10" x="359.5781" y="375.6094"/></g><g><title>TPM</title><rect fill="#000000" fill-opacity="0.00000" height="2994.0625" width="8" x="601.6807" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="605.1807" x2="605.1807" y1="126.5625" y2="3120.625"/></g><g><title/><rect fill="#FFFFFF" height="306.9688" style="stroke:#181818;stroke-width:1;" width="10" x="600.1807" y="516.375"/></g><g><title>Konnektor or</title><rect fill="#000000" fill-opacity="0.00000" height="2994.0625" width="8" x="678.4907" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="681.9907" x2="681.9907" y1="126.5625" y2="3120.625"/></g><g><title/><rect fill="#FFFFFF" height="76.9219" style="stroke:#181818;stroke-width:1;" width="10" x="676.9907" y="1631.9375"/></g><g><title>SM.C.-B</title><rect fill="#000000" fill-opacity="0.00000" height="2994.0625" width="8" x="787.687" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="791.187" x2="791.187" y1="126.5625" y2="3120.625"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="786.187" y="1657.5781"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="2994.0625" width="8" x="893.2764" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="896.7764" x2="896.7764" y1="126.5625" y2="3120.625"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="891.7764" y="152.2031"/></g><g><title/><rect fill="#FFFFFF" height="1155.7969" style="stroke:#181818;stroke-width:1;" width="10" x="891.7764" y="1932.8281"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="2994.0625" width="8" x="1151.584" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1155.084" x2="1155.084" y1="126.5625" y2="3120.625"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="1150.084" y="2507.6875"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="1150.084" y="2799.6563"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="2994.0625" width="8" x="1232.7275" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1236.2275" x2="1236.2275" y1="126.5625" y2="3120.625"/></g><g><title/><rect fill="#FFFFFF" height="60.5625" style="stroke:#181818;stroke-width:1;" width="10" x="1231.2275" y="2612.25"/></g><text fill="#000000" font-family="Helvetica" font-size="10" x="5" y="124.2041">User</text><ellipse cx="19.3965" cy="63.4219" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M19.3965,71.4219 L19.3965,98.4219 M6.3965,79.4219 L32.3965,79.4219 M19.3965,98.4219 L6.3965,113.4219 M19.3965,98.4219 L32.3965,113.4219" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="62.8179" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="71.2339" y="104.5635">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="69.8179" y="116.2041">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.6826" x="295.2368" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="302.2368" y="104.5635">ZETA Attestation Service</text><text fill="#000000" font-family="Helvetica" font-size="10" x="328.7114" y="116.2041">(Admin rights)</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="587.7974" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="594.7974" y="116.2041">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="642.564" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="649.564" y="104.5635">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="653.5703" y="116.2041">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="764.0723" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="771.0723" y="116.2041">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="838.3018" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="886.896" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="845.3018" y="116.2041">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61.7148" x="1124.2266" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1145.2036" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1131.2266" y="116.2041">Database</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1195.9414" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1226.3472" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1202.9414" y="116.2041">Policy Engine</text><text fill="#000000" font-family="Helvetica" font-size="10" x="5" y="3189.9072">User</text><ellipse cx="19.3965" cy="3129.125" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M19.3965,3137.125 L19.3965,3164.125 M6.3965,3145.125 L32.3965,3145.125 M19.3965,3164.125 L6.3965,3179.125 M19.3965,3164.125 L32.3965,3179.125" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="62.8179" y="3120.625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="71.2339" y="3136.9072">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="69.8179" y="3148.5479">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.6826" x="295.2368" y="3120.625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="302.2368" y="3136.9072">ZETA Attestation Service</text><text fill="#000000" font-family="Helvetica" font-size="10" x="328.7114" y="3148.5479">(Admin rights)</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="587.7974" y="3120.625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="594.7974" y="3136.9072">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="642.564" y="3120.625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="649.564" y="3136.9072">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="653.5703" y="3148.5479">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="764.0723" y="3120.625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="771.0723" y="3136.9072">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="838.3018" y="3120.625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="886.896" y="3136.9072">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="845.3018" y="3148.5479">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61.7148" x="1124.2266" y="3120.625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1145.2036" y="3136.9072">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1131.2266" y="3148.5479">Database</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1195.9414" y="3120.625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1226.3472" y="3136.9072">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1202.9414" y="3148.5479">Policy Engine</text><polygon fill="#181818" points="879.7764,148.2031,889.7764,152.2031,879.7764,156.2031,883.7764,152.2031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="885.7764" y1="152.2031" y2="152.2031"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="147.8447">(01)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="147.8447">GET /nonce</text><polygon fill="#181818" points="100.293,173.8438,90.293,177.8438,100.293,181.8438,96.293,177.8438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="94.293" x2="890.7764" y1="177.8438" y2="177.8438"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="173.4854">(02)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="173.4854">return 200 OK new-nonce: nonce</text><path d="M48.1777,189.8438 L108.1338,189.8438 L108.1338,193.4844 L98.1338,203.4844 L48.1777,203.4844 L48.1777,189.8438" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2351.4844" style="stroke:#000000;stroke-width:1.5;" width="1127.9063" x="48.1777" y="189.8438"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="63.1777" y="200.126">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="123.1338" y="201.126">[Initial SM(C)-B Token Exchangewith Attestation]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="48.1777" x2="1176.084" y1="2115.2344" y2="2115.2344"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="53.1777" y="2126.5166">[Refresh Token use (without Attestation)]</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="231.125" y2="231.125"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="231.125" y2="244.125"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="244.125" y2="244.125"/><polygon fill="#181818" points="100.293,240.125,90.293,244.125,100.293,248.125,96.293,244.125" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="226.7666">(03)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="226.7666">Create DPoP Key Pair (for Token Exchange)</text><path d="M349.9932,218.4844 L349.9932,239.4844 L575.9932,239.4844 L575.9932,228.4844 L565.9932,218.4844 L349.9932,218.4844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M565.9932,218.4844 L565.9932,228.4844 L575.9932,228.4844 L565.9932,218.4844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="355.9932" y="232.7666">Session-based Key Pair for DPoP binding.</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="269.7656" y2="269.7656"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="269.7656" y2="282.7656"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="282.7656" y2="282.7656"/><polygon fill="#181818" points="100.293,278.7656,90.293,282.7656,100.293,286.7656,96.293,282.7656" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="265.4072">(04)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="265.4072">Calculate attestation_challenge</text><path d="M290.75,257.125 L290.75,313.125 L583.75,313.125 L583.75,267.125 L573.75,257.125 L290.75,257.125" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M573.75,257.125 L573.75,267.125 L583.75,267.125 L573.75,257.125" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="296.75" y="271.4072">The attestation_challenge is a cryptographic hash</text><text fill="#000000" font-family="Helvetica" font-size="10" x="296.75" y="283.0479">of the Public Client Instance Key Hash and a nonce.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="296.75" y="294.6885">It is used to bind the attestation to the client instance.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="296.75" y="306.3291">attestation_challenge = HASH(pubKeyHash + nonce)</text><path d="M67.1777,322.6875 L127.1338,322.6875 L127.1338,326.3281 L117.1338,336.3281 L67.1777,336.3281 L67.1777,322.6875" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1141.2031" style="stroke:#000000;stroke-width:1.5;" width="809.0117" x="67.1777" y="322.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="82.1777" y="332.9697">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="142.1338" y="333.9697">[ZETA Attestation Service available]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="67.1777" x2="876.1895" y1="1195.7188" y2="1195.7188"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="72.1777" y="1207.001">[Fallback: Software-basierte Attestierung]</text><polygon fill="#181818" points="347.5781,371.6094,357.5781,375.6094,347.5781,379.6094,351.5781,375.6094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="353.5781" y1="375.6094" y2="375.6094"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="365.4307">(05)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="359.6104">Get Attestation</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="371.251">with `attestation_challenge`</text><path d="M374.5781,351.3281 L374.5781,454.3281 L744.5781,454.3281 L744.5781,361.3281 L734.5781,351.3281 L374.5781,351.3281" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M734.5781,351.3281 L734.5781,361.3281 L744.5781,361.3281 L734.5781,351.3281" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="365.6104">The Prim&#228;rsystem (PS) and the ZETA Attestation Service (ZTA) are</text><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="377.251">in the same trust domain. At the time of client installation, the ZTA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="388.8916">computes a cryptographic hash of the PS software and extends this</text><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="400.5322">hash into a specific PCR (22 or 23) using TPM2_PCR_Extend. The</text><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="412.1729">ZTA reads and stores the resulting PCR value as a reference</text><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="423.8135">measurement or baseline. At every start of the PS, the ZTA measures</text><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="435.4541">the PS software and extends the resulting hash into the same PCR</text><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="447.0947">(22 or 23) using TPM2_PCR_Extend.</text><path d="M348.5781,463.4531 L408.5342,463.4531 L408.5342,467.0938 L398.5342,477.0938 L348.5781,477.0938 L348.5781,463.4531" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="199.7656" style="stroke:#000000;stroke-width:1.5;" width="361.5029" x="348.5781" y="463.4531"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="363.5781" y="473.7354">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="423.5342" y="474.7354">[ZETA TPM Service has no TPM Attestation Key]</text><polygon fill="#181818" points="588.1807,512.375,598.1807,516.375,588.1807,520.375,592.1807,516.375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="369.5781" x2="594.1807" y1="516.375" y2="516.375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="376.5781" y="506.1963">(06)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="500.376">Generate Attestation Key Pair (AK)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="512.0166">and Get AK Handle</text><polygon fill="#181818" points="380.5781,549.6563,370.5781,553.6563,380.5781,557.6563,376.5781,553.6563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="374.5781" x2="599.1807" y1="553.6563" y2="553.6563"/><text fill="#000000" font-family="Helvetica" font-size="10" x="386.5781" y="543.4775">(07)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="411.1055" y="537.6572">Return Attestation Public Key</text><text fill="#000000" font-family="Helvetica" font-size="10" x="411.1055" y="549.2979">and AK Handle</text><polygon fill="#181818" points="588.1807,575.2969,598.1807,579.2969,588.1807,583.2969,592.1807,579.2969" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="369.5781" x2="594.1807" y1="579.2969" y2="579.2969"/><text fill="#000000" font-family="Helvetica" font-size="10" x="376.5781" y="574.9385">(08)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="574.9385">Get Certificate Chain</text><polygon fill="#181818" points="380.5781,600.9375,370.5781,604.9375,380.5781,608.9375,376.5781,604.9375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="374.5781" x2="599.1807" y1="604.9375" y2="604.9375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="386.5781" y="600.5791">(09)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="411.1055" y="600.5791">Return Certificate Chain</text><line style="stroke:#181818;stroke-width:1;" x1="369.5781" x2="411.5781" y1="642.2188" y2="642.2188"/><line style="stroke:#181818;stroke-width:1;" x1="411.5781" x2="411.5781" y1="642.2188" y2="655.2188"/><line style="stroke:#181818;stroke-width:1;" x1="370.5781" x2="411.5781" y1="655.2188" y2="655.2188"/><polygon fill="#181818" points="380.5781,651.2188,370.5781,655.2188,380.5781,659.2188,376.5781,655.2188" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="376.5781" y="632.04">(10)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="626.2197">Store AK Handle, AK Public Key</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="637.8604">and Certificate Chain</text><line style="stroke:#181818;stroke-width:1;" x1="369.5781" x2="411.5781" y1="694.8594" y2="694.8594"/><line style="stroke:#181818;stroke-width:1;" x1="411.5781" x2="411.5781" y1="694.8594" y2="707.8594"/><line style="stroke:#181818;stroke-width:1;" x1="370.5781" x2="411.5781" y1="707.8594" y2="707.8594"/><polygon fill="#181818" points="380.5781,703.8594,370.5781,707.8594,380.5781,711.8594,376.5781,707.8594" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="376.5781" y="690.501">(11)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="690.501">Select AK Handle</text><polygon fill="#181818" points="588.1807,776.0625,598.1807,780.0625,588.1807,784.0625,592.1807,780.0625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="369.5781" x2="594.1807" y1="780.0625" y2="780.0625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="376.5781" y="752.4229">(12)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="729.1416">Get TPM Quote for PCRs</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="740.7822">(4, 5, 7, 10, 11, 22 or 23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="752.4229">and `attestation_challenge`</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="764.0635">(as qualifyingData),</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="775.7041">signed with AK</text><path d="M88.1777,720.8594 L88.1777,764.8594 L359.1777,764.8594 L359.1777,730.8594 L349.1777,720.8594 L88.1777,720.8594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M349.1777,720.8594 L349.1777,730.8594 L359.1777,730.8594 L349.1777,720.8594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="94.1777" y="735.1416">Binding: `attestation_challenge` enth&#228;lt Hash des</text><text fill="#000000" font-family="Helvetica" font-size="10" x="94.1777" y="746.7822">Client Instance Public Keys und die Nonce.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="94.1777" y="758.4229">Das TPM signiert PCRs + `attestation_challenge`.</text><path d="M615.1807,720.8594 L615.1807,799.8594 L855.1807,799.8594 L855.1807,730.8594 L845.1807,720.8594 L615.1807,720.8594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M845.1807,720.8594 L845.1807,730.8594 L855.1807,730.8594 L845.1807,720.8594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="621.1807" y="735.1416">PCR 4: Boot Loader Code, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="621.1807" y="746.7822">PCR 5: Boot Loader Configuration, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="621.1807" y="758.4229">PCR 7: Secure Boot State / Policy, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="621.1807" y="770.0635">PCR   10:OS Kernel / IMA, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="621.1807" y="781.7041">PCR 11: OS Components / VSM, Digest,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="621.1807" y="793.3447">PCR 22 or 23 (if available) App Data, Digest</text><polygon fill="#181818" points="380.5781,819.3438,370.5781,823.3438,380.5781,827.3438,376.5781,823.3438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="374.5781" x2="599.1807" y1="823.3438" y2="823.3438"/><text fill="#000000" font-family="Helvetica" font-size="10" x="386.5781" y="818.9854">(13)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="411.1055" y="818.9854">Return TPM Quote</text><line style="stroke:#181818;stroke-width:1;" x1="369.5781" x2="411.5781" y1="848.9844" y2="848.9844"/><line style="stroke:#181818;stroke-width:1;" x1="411.5781" x2="411.5781" y1="848.9844" y2="861.9844"/><line style="stroke:#181818;stroke-width:1;" x1="370.5781" x2="411.5781" y1="861.9844" y2="861.9844"/><polygon fill="#181818" points="380.5781,857.9844,370.5781,861.9844,380.5781,865.9844,376.5781,861.9844" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="376.5781" y="844.626">(14)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="844.626">Get TCG Event Log (from OS/Firmware)</text><path d="M610.1807,836.3438 L610.1807,892.3438 L854.1807,892.3438 L854.1807,846.3438 L844.1807,836.3438 L610.1807,836.3438" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M844.1807,836.3438 L844.1807,846.3438 L854.1807,846.3438 L844.1807,836.3438" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="616.1807" y="850.626">Quote contains:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="616.1807" y="862.2666">- `attestation_challenge` (as qualifyingData)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="616.1807" y="873.9072">- Attested Data (PCR Select, PCR Digest),</text><text fill="#000000" font-family="Helvetica" font-size="10" x="616.1807" y="885.5479">- Signature</text><polygon fill="#181818" points="100.293,923.1875,90.293,927.1875,100.293,931.1875,96.293,927.1875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="94.293" x2="358.5781" y1="927.1875" y2="927.1875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="917.0088">(15)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="911.1885">Return Attestation</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="922.8291">(Quote, EventLog, CertChain)</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="964.4688" y2="964.4688"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="964.4688" y2="977.4688"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="977.4688" y2="977.4688"/><polygon fill="#181818" points="100.293,973.4688,90.293,977.4688,100.293,981.4688,96.293,977.4688" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="954.29">(16)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="948.4697">Create client_statement</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="960.1104">with posture-tpm</text><path d="M253.3965,940.1875 L253.3965,1019.1875 L462.3965,1019.1875 L462.3965,950.1875 L452.3965,940.1875 L253.3965,940.1875" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M452.3965,940.1875 L452.3965,950.1875 L462.3965,950.1875 L452.3965,940.1875" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="954.4697">client_statement includes:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="966.1104">- sub</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="977.751">- product_id</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="989.3916">- product_version</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1001.0322">- posture (containing TPM Quote etc.)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1012.6729">- attestation-info</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1042.6719" y2="1042.6719"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1042.6719" y2="1055.6719"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1055.6719" y2="1055.6719"/><polygon fill="#181818" points="100.293,1051.6719,90.293,1055.6719,100.293,1059.6719,96.293,1055.6719" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1038.3135">(17)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1038.3135">Create Client Assertion JWT</text><path d="M270.3789,1030.0313 L270.3789,1179.0313 L572.3789,1179.0313 L572.3789,1040.0313 L562.3789,1030.0313 L270.3789,1030.0313" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M562.3789,1030.0313 L562.3789,1040.0313 L572.3789,1040.0313 L562.3789,1030.0313" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="276.3789" y="1044.3135">Client Assertion JWT Claims (with Attestation):</text><text fill="#000000" font-family="Helvetica" font-size="10" x="276.3789" y="1055.9541">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1067.5947">"iss": "&lt;client_id&gt;", "sub": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1079.2354">"aud": "&lt;AS_Token_Endpoint_URL&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1090.876">"exp": ..., "jti": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1102.5166">// Embed the client_statement with attestation</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1114.1572">"urn:gematik:params:oauth:client-attestation:tpm2": {</text><text fill="#000000" font-family="Helvetica" font-size="10" x="292.2725" y="1125.7979">"attestation_data": "&lt;Base64(client_statement)&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="292.2725" y="1137.4385">"client_statement_format": "client-statement"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="285.915" y="1149.0791">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="276.3789" y="1160.7197">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="276.3789" y="1172.3604">(sig by Client_Instance_Private_Key)</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1243.6406" y2="1243.6406"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1243.6406" y2="1256.6406"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1256.6406" y2="1256.6406"/><polygon fill="#181818" points="100.293,1252.6406,90.293,1256.6406,100.293,1260.6406,96.293,1256.6406" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1233.4619">(18)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1227.6416">Create client_statement</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1239.2822">with posture-software</text><path d="M253.3965,1219.3594 L253.3965,1298.3594 L515.3965,1298.3594 L515.3965,1229.3594 L505.3965,1219.3594 L253.3965,1219.3594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M505.3965,1219.3594 L505.3965,1229.3594 L515.3965,1229.3594 L505.3965,1219.3594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1233.6416">client_statement includes:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1245.2822">- sub</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1256.9229">- product_id</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1268.5635">- product_version</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1280.2041">- posture (containing attestation_challenge etc.)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1291.8447">- attestation-info</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1321.8438" y2="1321.8438"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1321.8438" y2="1334.8438"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1334.8438" y2="1334.8438"/><polygon fill="#181818" points="100.293,1330.8438,90.293,1334.8438,100.293,1338.8438,96.293,1334.8438" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1317.4854">(19)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1317.4854">Create Client Assertion JWT</text><path d="M270.3789,1309.2031 L270.3789,1458.2031 L589.3789,1458.2031 L589.3789,1319.2031 L579.3789,1309.2031 L270.3789,1309.2031" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M579.3789,1309.2031 L579.3789,1319.2031 L589.3789,1319.2031 L579.3789,1309.2031" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="276.3789" y="1323.4854">Client Assertion JWT Claims (with Attestation):</text><text fill="#000000" font-family="Helvetica" font-size="10" x="276.3789" y="1335.126">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1346.7666">"iss": "&lt;client_id&gt;", "sub": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1358.4072">"aud": "&lt;AS_Token_Endpoint_URL&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1370.0479">"exp": ..., "jti": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1381.6885">// Embed the client_statement</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1393.3291">"urn:gematik:params:oauth:client-attestation:software": {</text><text fill="#000000" font-family="Helvetica" font-size="10" x="292.2725" y="1404.9697">"attestation_data": "&lt;Base64(client_statement)&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="292.2725" y="1416.6104">"client_statement_format": "client-statement"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="285.915" y="1428.251">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="276.3789" y="1439.8916">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="276.3789" y="1451.5322">(sig by Client_Instance_Private_Key)</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1495.5313" y2="1495.5313"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1495.5313" y2="1508.5313"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1508.5313" y2="1508.5313"/><polygon fill="#181818" points="100.293,1504.5313,90.293,1508.5313,100.293,1512.5313,96.293,1508.5313" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1491.1729">(20)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1491.1729">Create "SM(C)-B Access Token" (JWT)</text><path d="M320.0762,1482.8906 L320.0762,1608.8906 L753.0762,1608.8906 L753.0762,1492.8906 L743.0762,1482.8906 L320.0762,1482.8906" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M743.0762,1482.8906 L743.0762,1492.8906 L753.0762,1492.8906 L743.0762,1482.8906" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="326.0762" y="1497.1729">SM(C)-B Access Token Claims:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="326.0762" y="1508.8135">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.4336" y="1520.4541">"iss": "&lt;client_id&gt;", // Issuer is the client</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.4336" y="1532.0947">"sub": "&lt;Telematik-ID from SM(C)-B&gt;", // Subject is the institution</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.4336" y="1543.7354">"aud": "[&lt;Resource_Server_Endpoint_URL&gt;]", // Audience is the Resource Server</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.4336" y="1555.376">"exp": ..., // Short-lived</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.4336" y="1567.0166">"iat": ...,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.4336" y="1578.6572">"jti": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="332.4336" y="1590.2979">"scope": ... // As required for the Resource Server access</text><text fill="#000000" font-family="Helvetica" font-size="10" x="326.0762" y="1601.9385">}</text><polygon fill="#181818" points="664.9907,1627.9375,674.9907,1631.9375,664.9907,1635.9375,668.9907,1631.9375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="670.9907" y1="1631.9375" y2="1631.9375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1627.5791">(21)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1627.5791">externalAuthenticate (JWT-hash)</text><polygon fill="#181818" points="774.187,1653.5781,784.187,1657.5781,774.187,1661.5781,778.187,1657.5781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="686.9907" x2="780.187" y1="1657.5781" y2="1657.5781"/><text fill="#000000" font-family="Helvetica" font-size="10" x="693.9907" y="1653.2197">(22)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="718.5181" y="1653.2197">sign (hash)</text><polygon fill="#181818" points="697.9907,1679.2188,687.9907,1683.2188,697.9907,1687.2188,693.9907,1683.2188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="691.9907" x2="785.187" y1="1683.2188" y2="1683.2188"/><text fill="#000000" font-family="Helvetica" font-size="10" x="703.9907" y="1678.8604">(23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="728.5181" y="1678.8604">Signature</text><polygon fill="#181818" points="100.293,1704.8594,90.293,1708.8594,100.293,1712.8594,96.293,1708.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="94.293" x2="675.9907" y1="1708.8594" y2="1708.8594"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="1704.501">(24)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="1704.501">JWT-signature</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1734.5" y2="1734.5"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1734.5" y2="1747.5"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1747.5" y2="1747.5"/><polygon fill="#181818" points="100.293,1743.5,90.293,1747.5,100.293,1751.5,96.293,1747.5" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1730.1416">(25)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1730.1416">Add JWT-Signature to SM(C)-B Access Token</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1773.1406" y2="1773.1406"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1773.1406" y2="1786.1406"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1786.1406" y2="1786.1406"/><polygon fill="#181818" points="100.293,1782.1406,90.293,1786.1406,100.293,1790.1406,96.293,1786.1406" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1768.7822">(26)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1768.7822">Create DPoP Proof JWT for Token Exchange</text><path d="M349.3584,1760.5 L349.3584,1909.5 L627.3584,1909.5 L627.3584,1770.5 L617.3584,1760.5 L349.3584,1760.5" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M617.3584,1760.5 L617.3584,1770.5 L627.3584,1770.5 L617.3584,1760.5" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="355.3584" y="1774.7822">DPoP Proof JWT Claims (for Token Exchange):</text><text fill="#000000" font-family="Helvetica" font-size="10" x="355.3584" y="1786.4229">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1798.0635">"typ": "dpop+jwt",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1809.7041">"alg": "ES256",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1821.3447">"jwk": { ... }</text><text fill="#000000" font-family="Helvetica" font-size="10" x="355.3584" y="1832.9854">}.{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1844.626">"jti": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1856.2666">"htm": "POST",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1867.9072">"htu": "&lt;AS_Token_Endpoint_URL&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1879.5479">"nonce": "&lt;nonce from AS&gt;", // Binding to AS</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1891.1885">"iat": ...</text><text fill="#000000" font-family="Helvetica" font-size="10" x="355.3584" y="1902.8291">}.(sig by DPoP_Private_Key)</text><polygon fill="#181818" points="879.7764,1928.8281,889.7764,1932.8281,879.7764,1936.8281,883.7764,1932.8281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="885.7764" y1="1932.8281" y2="1932.8281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1928.4697">(27)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1928.4697">POST /token (RFC 8693) DPoP: &lt;signed_dpop_jwt&gt;</text><path d="M94.293,1945.8281 L94.293,2036.8281 L507.293,2036.8281 L507.293,1955.8281 L497.293,1945.8281 L94.293,1945.8281" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M497.293,1945.8281 L497.293,1955.8281 L507.293,1955.8281 L497.293,1945.8281" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="100.293" y="1960.1104">Token Exchange Request Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="1971.751">grant_type=urn:ietf:params:oauth:grant-type:token-exchange</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="1983.3916">&amp;subject_token=&lt;SM(C)-B_Access_Token&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="1995.0322">&amp;subject_token_type=urn:ietf:params:oauth:token-type:jwt</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2006.6729">&amp;client_assertion_type=urn:ietf:params:oauth:client-assertion-type:jwt-bearer</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2018.3135">&amp;client_assertion=&lt;Client_Assertion_JWT&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2029.9541">...</text><line style="stroke:#181818;stroke-width:1;" x1="901.7764" x2="943.7764" y1="2083.2344" y2="2083.2344"/><line style="stroke:#181818;stroke-width:1;" x1="943.7764" x2="943.7764" y1="2083.2344" y2="2096.2344"/><line style="stroke:#181818;stroke-width:1;" x1="902.7764" x2="943.7764" y1="2096.2344" y2="2096.2344"/><polygon fill="#181818" points="912.7764,2092.2344,902.7764,2096.2344,912.7764,2100.2344,908.7764,2096.2344" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="908.7764" y="2067.2354">(28)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2055.5947">Validate Request (Client Assertion,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2067.2354">Attestation, DPoP Proof,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2078.876">Subject Token)</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="2151.5156" y2="2151.5156"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="2151.5156" y2="2164.5156"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="2164.5156" y2="2164.5156"/><polygon fill="#181818" points="100.293,2160.5156,90.293,2164.5156,100.293,2168.5156,96.293,2164.5156" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="2147.1572">(29)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="2147.1572">Create Client Assertion JWT without Attestation</text><path d="M369.5781,2138.875 L369.5781,2252.875 L672.5781,2252.875 L672.5781,2148.875 L662.5781,2138.875 L369.5781,2138.875" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M662.5781,2138.875 L662.5781,2148.875 L672.5781,2148.875 L662.5781,2138.875" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="375.5781" y="2153.1572">Client Assertion JWT Claims (without Attestation):</text><text fill="#000000" font-family="Helvetica" font-size="10" x="375.5781" y="2164.7979">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="381.9355" y="2176.4385">"iss": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="381.9355" y="2188.0791">"sub": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="381.9355" y="2199.7197">"aud": "&lt;AS_Token_Endpoint_URL&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="381.9355" y="2211.3604">"exp": ...,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="381.9355" y="2223.001">"jti": "..."</text><text fill="#000000" font-family="Helvetica" font-size="10" x="375.5781" y="2234.6416">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="375.5781" y="2246.2822">(sig by Client_Instance_Private_Key)</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="2276.2813" y2="2276.2813"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="2276.2813" y2="2289.2813"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="2289.2813" y2="2289.2813"/><polygon fill="#181818" points="100.293,2285.2813,90.293,2289.2813,100.293,2293.2813,96.293,2289.2813" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="2271.9229">(30)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="2271.9229">Create DPoP Proof JWT for Token Exchange</text><polygon fill="#181818" points="879.7764,2310.9219,889.7764,2314.9219,879.7764,2318.9219,883.7764,2314.9219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="885.7764" y1="2314.9219" y2="2314.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="2310.5635">(31)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="2310.5635">POST /token DPoP: &lt;signed_dpop_jwt&gt;</text><path d="M94.293,2327.9219 L94.293,2395.9219 L507.293,2395.9219 L507.293,2337.9219 L497.293,2327.9219 L94.293,2327.9219" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M497.293,2327.9219 L497.293,2337.9219 L507.293,2337.9219 L497.293,2327.9219" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="100.293" y="2342.2041">Token Exchange Request Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2353.8447">grant_type=refresh_token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2365.4854">&amp;refresh_token=&lt;Refresh_Token&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2377.126">&amp;client_assertion_type=urn:ietf:params:oauth:client-assertion-type:jwt-bearer</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2388.7666">&amp;client_assertion=&lt;Client_Assertion_JWT_</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="312.8564" y="2388.7666">without</text><text fill="#000000" font-family="Helvetica" font-size="10" x="356.1914" y="2388.7666">_Attestation&gt;</text><line style="stroke:#181818;stroke-width:1;" x1="901.7764" x2="943.7764" y1="2430.4063" y2="2430.4063"/><line style="stroke:#181818;stroke-width:1;" x1="943.7764" x2="943.7764" y1="2430.4063" y2="2443.4063"/><line style="stroke:#181818;stroke-width:1;" x1="902.7764" x2="943.7764" y1="2443.4063" y2="2443.4063"/><polygon fill="#181818" points="912.7764,2439.4063,902.7764,2443.4063,912.7764,2447.4063,908.7764,2443.4063" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="908.7764" y="2420.2275">(32)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2414.4072">Validate Request (Client Assertion,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2426.0479">DPoP Proof, Refresh Token)</text><line style="stroke:#181818;stroke-width:1;" x1="901.7764" x2="943.7764" y1="2469.0469" y2="2469.0469"/><line style="stroke:#181818;stroke-width:1;" x1="943.7764" x2="943.7764" y1="2469.0469" y2="2482.0469"/><line style="stroke:#181818;stroke-width:1;" x1="902.7764" x2="943.7764" y1="2482.0469" y2="2482.0469"/><polygon fill="#181818" points="912.7764,2478.0469,902.7764,2482.0469,912.7764,2486.0469,908.7764,2482.0469" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="908.7764" y="2464.6885">(33)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2464.6885">Invalidate Refresh token</text><polygon fill="#181818" points="1138.084,2503.6875,1148.084,2507.6875,1138.084,2511.6875,1142.084,2507.6875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="901.7764" x2="1144.084" y1="2507.6875" y2="2507.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="908.7764" y="2503.3291">(34)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2503.3291">Get Client Data, Session Data, User Data</text><polygon fill="#181818" points="912.7764,2529.3281,902.7764,2533.3281,912.7764,2537.3281,908.7764,2533.3281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="906.7764" x2="1149.084" y1="2533.3281" y2="2533.3281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="918.7764" y="2528.9697">(35)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="943.3037" y="2528.9697">Client Data, Session Data, User Data</text><path d="M49.293,2559.3281 L109.249,2559.3281 L109.249,2562.9688 L99.249,2572.9688 L49.293,2572.9688 L49.293,2559.3281" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="537.2969" style="stroke:#000000;stroke-width:1.5;" width="1207.9346" x="49.293" y="2559.3281"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="64.293" y="2569.6104">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="124.249" y="2570.6104">[Validations Successful]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="49.293" x2="1257.2275" y1="3052.3438" y2="3052.3438"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="54.293" y="3063.626">[Validation Failed]</text><polygon fill="#181818" points="1219.2275,2608.25,1229.2275,2612.25,1219.2275,2616.25,1223.2275,2612.25" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="901.7764" x2="1225.2275" y1="2612.25" y2="2612.25"/><text fill="#000000" font-family="Helvetica" font-size="10" x="908.7764" y="2602.0713">(36)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2596.251">POST /v1/data/authz, body</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2607.8916">{  "input": {...}}</text><polygon fill="#181818" points="912.7764,2668.8125,902.7764,2672.8125,912.7764,2676.8125,908.7764,2672.8125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="906.7764" x2="1230.2275" y1="2672.8125" y2="2672.8125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="918.7764" y="2650.9932">(37)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="943.3037" y="2633.5322">200 OK, body {"allow": true,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="949.6611" y="2645.1729">"access_token_ttl": "360",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="949.6611" y="2656.8135">"refresh_token_ttl": "43200",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="949.6611" y="2668.4541">"scope": "RS specific scopes"}</text><path d="M68.293,2684.8125 L128.249,2684.8125 L128.249,2688.4531 L118.249,2698.4531 L68.293,2698.4531 L68.293,2684.8125" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="342.5313" style="stroke:#000000;stroke-width:1.5;" width="1135.4541" x="68.293" y="2684.8125"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="83.293" y="2695.0947">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="143.249" y="2696.0947">[Policy Decision allowed]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="68.293" x2="1203.7471" y1="2983.0625" y2="2983.0625"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="73.293" y="2994.3447">[Policy Decision denied]</text><line style="stroke:#181818;stroke-width:1;" x1="901.7764" x2="943.7764" y1="2737.7344" y2="2737.7344"/><line style="stroke:#181818;stroke-width:1;" x1="943.7764" x2="943.7764" y1="2737.7344" y2="2750.7344"/><line style="stroke:#181818;stroke-width:1;" x1="902.7764" x2="943.7764" y1="2750.7344" y2="2750.7344"/><polygon fill="#181818" points="912.7764,2746.7344,902.7764,2750.7344,912.7764,2754.7344,908.7764,2750.7344" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="908.7764" y="2727.5557">(38)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2721.7354">Generate AS Access Token (AT)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2733.376">and Refresh Token (RT)</text><polygon fill="#181818" points="1138.084,2795.6563,1148.084,2799.6563,1138.084,2803.6563,1142.084,2799.6563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="901.7764" x2="1144.084" y1="2799.6563" y2="2799.6563"/><text fill="#000000" font-family="Helvetica" font-size="10" x="908.7764" y="2783.6572">(39)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2772.0166">Update Client Data</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2783.6572">Update Session</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2795.2979">Update User Data</text><polygon fill="#181818" points="912.7764,2821.2969,902.7764,2825.2969,912.7764,2829.2969,908.7764,2825.2969" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="906.7764" x2="1149.084" y1="2825.2969" y2="2825.2969"/><text fill="#000000" font-family="Helvetica" font-size="10" x="918.7764" y="2820.9385">(40)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="943.3037" y="2820.9385">updated</text><polygon fill="#181818" points="100.293,2846.9375,90.293,2850.9375,100.293,2854.9375,96.293,2850.9375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="94.293" x2="890.7764" y1="2850.9375" y2="2850.9375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="2846.5791">(41)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="2846.5791">200 OK, new tokens</text><path d="M906.7764,2863.9375 L906.7764,2966.9375 L1181.7764,2966.9375 L1181.7764,2873.9375 L1171.7764,2863.9375 L906.7764,2863.9375" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><path d="M1171.7764,2863.9375 L1171.7764,2873.9375 L1181.7764,2873.9375 L1171.7764,2863.9375" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="912.7764" y="2878.2197">Token Response Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="912.7764" y="2889.8604">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="919.1338" y="2901.501">"access_token": "&lt;AS_Access_Token&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="919.1338" y="2913.1416">"token_type": "DPoP", // Indicate DPoP is required</text><text fill="#000000" font-family="Helvetica" font-size="10" x="919.1338" y="2924.7822">"expires_in": 300,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="919.1338" y="2936.4229">"refresh_token": "&lt;AS_Refresh_Token&gt;"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="919.1338" y="2948.0635">// ... other parameters</text><text fill="#000000" font-family="Helvetica" font-size="10" x="912.7764" y="2959.7041">}</text><polygon fill="#181818" points="100.293,3015.3438,90.293,3019.3438,100.293,3023.3438,96.293,3019.3438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="94.293" x2="890.7764" y1="3019.3438" y2="3019.3438"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="3014.9854">(42)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="3014.9854">403 Forbidden</text><polygon fill="#181818" points="100.293,3084.625,90.293,3088.625,100.293,3092.625,96.293,3088.625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="94.293" x2="890.7764" y1="3088.625" y2="3088.625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="3084.2666">(43)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="3084.2666">400 Bad Request</text><!--SRC=[xLhXSjl64VwFfzWoCmqf4v8iEqxBiJn3KRIiIfPOaKdQb1tc21p9iy433Hmaonw_JTuaBzRTkmDm047BQPjsfjEPP0JYTlVsTh_zRkzWbgbOPkivJw3LFZpijBpqhP0Rbh0rX7p1iaYzZAKQYmyS7Xys3rwnDOTNFBhbIWJCaJarCgzZ6QSR5l2ma1x4MI9uuiX6N2xLgX- -oL85CfRS6KlvkupBWD_m1K_euOG5RvT9dCbm44Tn0Z-iX78LndM5SWr7ti7N3mcg-uZ3F8v2x-i3p_lT9c7BDGF5um-WaenxNZzGEEjtAQvW7h-7rkNml0LVdQtYL1bN0FJxKIBMl_oSfFUfuckKk6ItN8Qe1M0bVXnE-Z2819SAnyTCXlSdINmdjGG0Uean5HicbPK2bXgjgRHgMXJDaa6lhlHZVrneG5yfdYgcH2nnvScj2FXKjllXMaX8n7Abqavhoy9az5fRmByqM4xa2bt4KlAt51GIBN_5oLHEplqpflWTks_LjCQlJxJy-7LxqF5FMbvkt4IrB-U2AvvWO2R3mQkhwylhixzwRk3ECfQ4st5pv-XdQcL2C3eTJINzZ1FneGm2sjzIGj7JarBfb2asPobl41oMKgCu4i4z3ELIIEw6gbYLpU2ZH_cJ_yBwz-WHzE1iE843X7x0FVFMn_5Sqkz1mbMMI3WwF8Jh2v3ypjV2FJ0wtjTmV7mCuqd_PjA3oVN5y0g6Vncywb-T3M4y74pEhwz8mcEHWdCfb60HsD3397xB9GpV1oicb_nEg9MB5bnCwR5zwi4WuPXNE1t58xZWzp1Y8e7s0jDUjTP1THcZfCPO3wEUfcZKfv26fIOfQbjp8KCXb_jUmxGuAuk2BAA9MUdW36UAY49uRQx9QeSSY1GO1CdzHiNBX6rM8e0LIrTJ6Iz0eTOecsC-SmVE9Lh0A6jtNw4S8EJGW0xz_bIUApAOqO9Kh5UWZJXJqtjw5HY3mXf4tMR_Zk5LV_oglSdcEAMUyP6PZSA9_rMotPzCXlYeK-oc6e2IlQluWTqo4R5vn3MmorWJQnX8SkKgJgL6na-D7l-aZHJp4M_ays1WqNVzodK35sPvhfwo2d52UpJkw7XJ_7OkfltZf8zY2N8QyXc9fhJL86FZZXB6QoRaFYhg4ILm11Fj9YEAjBskcOK8DeZNcmmdQWGAv3WPGnelr1rEh7taxnKMV8fZ8frABIaavfv1kk61MA3wQ703xQCZP4SuUj91r23QAJX7CnoP3RM1VOh3LA8VMFSCxP7j53cLftfQ_8jRAocIjLiMPPoeYE60tSgcSirPcYLyJKl4kQZU8kGc7GMEn7UF1f7CofKKQmUhYYlu_1fTHygr5i57tt27UMYf5WI4EWGVeSI2J_A42hs66Kiq_OiErWvweq5wWLKfGujaq4PyW-GUt1ZYTCtOwaPhnaPTl_J55C608-bZxiYTmGgXz9bvTibQcrfqJ9aiP-tIOzsdPZkqcs2HUTwMIHxne1w9-Zh8tpzdL6r4jvW3p73xQHU-wSAtNUpmyF_7NIWIPXpPKU-eYOXxbx58BEunhxHDThfJcOgbH1uqcyY5LzHtn1TOtYU6tNkxhE82rUgNdv56DEc5XC4w2PUHGiv51qF1uSeoyIdwHAiaBx35L7gHo9qxfjltwln3zVGK_OnZ1PSnmtODszKGKtGgbcW0DteK-AOk81TYcIMMGLp9Roap0TQIKHWhIkS1c6wXAWgOWDxr6DULI1wXqFdhVbNYyUCUeC00YGbRPAbI5Ff-_3eNwXgfF7tG5ekIuplGtso0afIBUpK4wox3WhW0oXRED8m6Pp2yfPnSnalSyvDuZNuTl1J9caYYinLKWxa0ksl4STgRIdzd_Xj0HUAcUX5Nz0Qt15odGNnNPyoiYE3dmnXJpt0LZk_LJcgR413BsiMkMHQkgglhJzTTfxOz5gs8QO3C9Z8ZIvfhxIwvmTC0-k2hpNeh77KLfCqWoX3hEZ9fDgS_coGEiq3DHEZ-GjvEjSD-FWEqRLmjjzfWSnNiwyWvSVQ5NCIDgodxEVkxdwR4FyYLV_fXKbi0V1NHdpbkEfRR0FRscXJH6XFh5DhrbhBJszihT3yMJm0jaQQj7hIUsnY9y4Mh2osCoTPRLujbeHxlZsUw-vmDPRY9SJUQVNTpMPFbxpSekx-_ZtRVA45w-ACYSt00GpmLXqxBvcHBBuPL-kF2E0Ahj-HhVF-sfm-PQIzcsCxtZ1NVKUiXD8vmTdVvUYrEOOI8Thsm4zozdprjrttfLDT6wdMH6L8z-aDMh0_5KCjL_UHjFxMHHc5-Rq4nonbuXWtQBTgO8GLtYcr96hhWKShX9TRp78_fo7wsSw1-dmWvty_nEPFBVwcqygRaFrXVpStw_sljjwgrVxQqScZy3vQNRG3p8-3mwdJt0R1-KCpF-_qWm5EuFQXhC1A8p95nDrnRJUejQ2FugeVyRT3kxJLFhI5RuhFCLJCs4IldQPfXooLI1o-bLexT2VO66Yd- -Ide_iJERwsCi_aRQfUj6Je12fLLo3p7-T-Ut_0qpXBCYxamgkBzxyPWFyCkb9fJQp7NiPTCNbD5a1-hE55-96vvw2nTmub4odUDnTDAWtZ3ZQns8iNpsBjC95XDrE0tE09CnzyheLXWgvBxyX9F7yReo9T85j7D54gOKmabtgTZ7sM_L41jkjhJUjI6GpkNeTT-nRZlev3RiBb3JjE6KZHPwaWsuBGVXbgiC4YtBat0ynw-qXebCHwCYLUthxGU17lDGixC3PTZZTXNzuIH5g9iy-ZDdN8ppg8b3Gt7HzyySz-_kNjBNAUHa1FCf_sF3m5efTRqTdGzdbHVPrz6yIrz9wLbzPEfjVxObfazxL4Q-kC6W1UEvan8WQlJdqD-3kKzJ6ML73iNhRHOE51QeNtpSW1_UFR79nqzTG-Uc-FhZ68_mzY_gE_7c59hjPRtlRrgQh7otcMuq-31BxpFqxnC60OHyykFQJiJN2sgUvaMy4cWfptqUOavWD-dXhTcUkpukGt2p0J1vEf5W-JdPZJJw1bnlKRPaYxB-ulFwUUxRovRcFBd77VWfDdYyNExwHKzp0mhnVYU0yD9lBqHp_FOW-_nX1XIiUPHRjTx8ZmBEarGrwbg7CdvNqUiutcwQRtXYuIdAukb3D_eNYhEAhUW7U_NjdJGOEL12dcmnQkxzSMxwFPksJpwnNsUiwSryerNxNk-iEjftfT-FLTlqq2L0dRN_MzHzOd1c2bBKngLLyVFBGehnVpVgiVPtfw5sjxUp07R2-_VK9rEGLPBhxDbiWVdyhQqQMJp41QYvhjTyUN2JccklEnN9_kBljtgHrGtMdxXFTqGVP5gteaxcz9dFhkXcDk9Vz-_F3_TRjZf-uaD7awPOf-gcNsHHPM53jsTxFRn0PrZ3YZx7xemH-1DvKSgVhd9QAFzY4NuYQeFzQhhD1yJZGvynEOYYkzGWJvpOuA80yp6OZSH5L59Ftbss3AZ5UJcmq-Ve5KhaFUdhPjn-Vr3lqnRd-pdAVlXz1H7TPYr4xOTtW9M-L5WNDtvs_s9lQwkidZxPjAfcd9GyjqcT3YRaZgLzfrDUl7RHKmpPZ8jMF7RkT788otvdG5kMb1bbMQCgc6PPSAvT8xzPadOqMyG6xn2CLjdUpTpEOrNseJgGRri4qYOIjCUjx212mgY5UK1etRAnrVfJD1CJmuFAvOh8CazgP9SgteTG3riZEUC13InqJy2I6kdv_fzKnr48PTYPowU7Zw1bt4o5s6emviNihPKLX-yP2BIHXg-nmEPEOGJ5kOSryG7Ewgy-0S0_Zy0]--></g></svg>