<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="3329px" preserveAspectRatio="none" style="width:1286px;height:3329px;background:#FFFFFF;" version="1.1" viewBox="0 0 1286 3329" width="1286px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="3317.0313" style="stroke:#181818;stroke-width:0.5;" width="782.5088" x="39.793" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="422.5854" y="15.2822">LEI</text><rect fill="#E6E6FA" height="3300.3906" style="stroke:#181818;stroke-width:0.5;" width="586.771" x="39.793" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="294.0818" y="31.9229">Prim&#228;rsystem</text><rect fill="#F4A460" height="3283.75" style="stroke:#181818;stroke-width:0.5;" width="89" x="39.793" y="39.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="51.793" y="48.5635">ZETA Client</text><rect fill="#C9FFC9" height="3317.0313" style="stroke:#181818;stroke-width:0.5;" width="446.2119" x="834.3018" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1033.0474" y="15.2822">Anbieter</text><rect fill="#F4A460" height="3300.3906" style="stroke:#181818;stroke-width:0.5;" width="446.2119" x="834.3018" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1024.2632" y="31.9229">ZETA Guard</text><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="3118.8281" width="8" x="15.8965" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="19.3965" x2="19.3965" y1="126.5625" y2="3245.3906"/></g><g><title>ZETA</title><rect fill="#000000" fill-opacity="0.00000" height="3118.8281" width="8" x="80.793" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="84.293" x2="84.293" y1="126.5625" y2="3245.3906"/></g><g><title/><rect fill="#FFFFFF" height="3105.8281" style="stroke:#181818;stroke-width:1;" width="10" x="79.293" y="134.5625"/></g><g><title>ZETA Attestation Service</title><rect fill="#000000" fill-opacity="0.00000" height="3118.8281" width="8" x="361.0781" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="364.5781" x2="364.5781" y1="126.5625" y2="3245.3906"/></g><g><title/><rect fill="#FFFFFF" height="551.5781" style="stroke:#181818;stroke-width:1;" width="10" x="359.5781" y="375.6094"/></g><g><title>TPM</title><rect fill="#000000" fill-opacity="0.00000" height="3118.8281" width="8" x="601.6807" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="605.1807" x2="605.1807" y1="126.5625" y2="3245.3906"/></g><g><title/><rect fill="#FFFFFF" height="306.9688" style="stroke:#181818;stroke-width:1;" width="10" x="600.1807" y="516.375"/></g><g><title>Konnektor or</title><rect fill="#000000" fill-opacity="0.00000" height="3118.8281" width="8" x="678.4907" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="681.9907" x2="681.9907" y1="126.5625" y2="3245.3906"/></g><g><title/><rect fill="#FFFFFF" height="76.9219" style="stroke:#181818;stroke-width:1;" width="10" x="676.9907" y="1631.9375"/></g><g><title>SM.C.-B</title><rect fill="#000000" fill-opacity="0.00000" height="3118.8281" width="8" x="787.687" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="791.187" x2="791.187" y1="126.5625" y2="3245.3906"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="786.187" y="1657.5781"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="3118.8281" width="8" x="893.2764" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="896.7764" x2="896.7764" y1="126.5625" y2="3245.3906"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="891.7764" y="152.2031"/></g><g><title/><rect fill="#FFFFFF" height="1280.5625" style="stroke:#181818;stroke-width:1;" width="10" x="891.7764" y="1932.8281"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="3118.8281" width="8" x="1151.584" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1155.084" x2="1155.084" y1="126.5625" y2="3245.3906"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="1150.084" y="2530.9688"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="1150.084" y="2924.4219"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="3118.8281" width="8" x="1232.7275" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1236.2275" x2="1236.2275" y1="126.5625" y2="3245.3906"/></g><g><title/><rect fill="#FFFFFF" height="162.0469" style="stroke:#181818;stroke-width:1;" width="10" x="1231.2275" y="2635.5313"/></g><text fill="#000000" font-family="Helvetica" font-size="10" x="5" y="124.2041">User</text><ellipse cx="19.3965" cy="63.4219" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M19.3965,71.4219 L19.3965,98.4219 M6.3965,79.4219 L32.3965,79.4219 M19.3965,98.4219 L6.3965,113.4219 M19.3965,98.4219 L32.3965,113.4219" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="62.8179" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="71.2339" y="104.5635">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="69.8179" y="116.2041">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.6826" x="295.2368" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="302.2368" y="104.5635">ZETA Attestation Service</text><text fill="#000000" font-family="Helvetica" font-size="10" x="328.7114" y="116.2041">(Admin rights)</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="587.7974" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="594.7974" y="116.2041">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="642.564" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="649.564" y="104.5635">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="653.5703" y="116.2041">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="764.0723" y="99.9219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="771.0723" y="116.2041">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="838.3018" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="886.896" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="845.3018" y="116.2041">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61.7148" x="1124.2266" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1145.2036" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1131.2266" y="116.2041">Database</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1195.9414" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1226.3472" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1202.9414" y="116.2041">Policy Engine</text><text fill="#000000" font-family="Helvetica" font-size="10" x="5" y="3314.6729">User</text><ellipse cx="19.3965" cy="3253.8906" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M19.3965,3261.8906 L19.3965,3288.8906 M6.3965,3269.8906 L32.3965,3269.8906 M19.3965,3288.8906 L6.3965,3303.8906 M19.3965,3288.8906 L32.3965,3303.8906" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="62.8179" y="3245.3906"/><text fill="#000000" font-family="Helvetica" font-size="10" x="71.2339" y="3261.6729">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="69.8179" y="3273.3135">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.6826" x="295.2368" y="3245.3906"/><text fill="#000000" font-family="Helvetica" font-size="10" x="302.2368" y="3261.6729">ZETA Attestation Service</text><text fill="#000000" font-family="Helvetica" font-size="10" x="328.7114" y="3273.3135">(Admin rights)</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="34.7666" x="587.7974" y="3245.3906"/><text fill="#000000" font-family="Helvetica" font-size="10" x="594.7974" y="3261.6729">TPM</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="78.8535" x="642.564" y="3245.3906"/><text fill="#000000" font-family="Helvetica" font-size="10" x="649.564" y="3261.6729">Konnektor or</text><text fill="#000000" font-family="Helvetica" font-size="10" x="653.5703" y="3273.3135">TI-Gateway</text><rect fill="#E2E2F0" height="25.6406" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.2295" x="764.0723" y="3245.3906"/><text fill="#000000" font-family="Helvetica" font-size="10" x="771.0723" y="3261.6729">SM(C)-B</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="838.3018" y="3245.3906"/><text fill="#000000" font-family="Helvetica" font-size="10" x="886.896" y="3261.6729">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="845.3018" y="3273.3135">Authorization Server</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="61.7148" x="1124.2266" y="3245.3906"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1145.2036" y="3261.6729">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1131.2266" y="3273.3135">Database</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.5723" x="1195.9414" y="3245.3906"/><text fill="#000000" font-family="Helvetica" font-size="10" x="1226.3472" y="3261.6729">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1202.9414" y="3273.3135">Policy Engine</text><polygon fill="#181818" points="879.7764,148.2031,889.7764,152.2031,879.7764,156.2031,883.7764,152.2031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="885.7764" y1="152.2031" y2="152.2031"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="147.8447">(01)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="147.8447">GET /nonce</text><polygon fill="#181818" points="100.293,173.8438,90.293,177.8438,100.293,181.8438,96.293,177.8438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="94.293" x2="890.7764" y1="177.8438" y2="177.8438"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="173.4854">(02)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="173.4854">return 200 OK new-nonce: nonce</text><path d="M48.1777,189.8438 L108.1338,189.8438 L108.1338,193.4844 L98.1338,203.4844 L48.1777,203.4844 L48.1777,189.8438" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2374.7656" style="stroke:#000000;stroke-width:1.5;" width="1127.9063" x="48.1777" y="189.8438"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="63.1777" y="200.126">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="123.1338" y="201.126">[Initial SM(C)-B Token Exchangewith Attestation]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="48.1777" x2="1176.084" y1="2138.5156" y2="2138.5156"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="53.1777" y="2149.7979">[Refresh Token use (without Attestation)]</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="231.125" y2="231.125"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="231.125" y2="244.125"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="244.125" y2="244.125"/><polygon fill="#181818" points="100.293,240.125,90.293,244.125,100.293,248.125,96.293,244.125" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="226.7666">(03)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="226.7666">Create DPoP Key Pair (for Token Exchange)</text><path d="M349.9932,218.4844 L349.9932,239.4844 L575.9932,239.4844 L575.9932,228.4844 L565.9932,218.4844 L349.9932,218.4844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M565.9932,218.4844 L565.9932,228.4844 L575.9932,228.4844 L565.9932,218.4844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="355.9932" y="232.7666">Session-based Key Pair for DPoP binding.</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="269.7656" y2="269.7656"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="269.7656" y2="282.7656"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="282.7656" y2="282.7656"/><polygon fill="#181818" points="100.293,278.7656,90.293,282.7656,100.293,286.7656,96.293,282.7656" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="265.4072">(04)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="265.4072">Calculate attestation_challenge</text><path d="M290.75,257.125 L290.75,313.125 L583.75,313.125 L583.75,267.125 L573.75,257.125 L290.75,257.125" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M573.75,257.125 L573.75,267.125 L583.75,267.125 L573.75,257.125" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="296.75" y="271.4072">The attestation_challenge is a cryptographic hash</text><text fill="#000000" font-family="Helvetica" font-size="10" x="296.75" y="283.0479">of the Public Client Instance Key Hash and a nonce.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="296.75" y="294.6885">It is used to bind the attestation to the client instance.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="296.75" y="306.3291">attestation_challenge = HASH(pubKeyHash + nonce)</text><path d="M67.1777,322.6875 L127.1338,322.6875 L127.1338,326.3281 L117.1338,336.3281 L67.1777,336.3281 L67.1777,322.6875" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1141.2031" style="stroke:#000000;stroke-width:1.5;" width="809.0117" x="67.1777" y="322.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="82.1777" y="332.9697">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="142.1338" y="333.9697">[ZETA Attestation Service available]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="67.1777" x2="876.1895" y1="1195.7188" y2="1195.7188"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="72.1777" y="1207.001">[Fallback: Software-basierte Attestierung]</text><polygon fill="#181818" points="347.5781,371.6094,357.5781,375.6094,347.5781,379.6094,351.5781,375.6094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="353.5781" y1="375.6094" y2="375.6094"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="365.4307">(05)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="359.6104">Get Attestation</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="371.251">with `attestation_challenge`</text><path d="M374.5781,351.3281 L374.5781,454.3281 L744.5781,454.3281 L744.5781,361.3281 L734.5781,351.3281 L374.5781,351.3281" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M734.5781,351.3281 L734.5781,361.3281 L744.5781,361.3281 L734.5781,351.3281" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="365.6104">The Prim&#228;rsystem (PS) and the ZETA Attestation Service (ZTA) are</text><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="377.251">in the same trust domain. At the time of client installation, the ZTA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="388.8916">computes a cryptographic hash of the PS software and extends this</text><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="400.5322">hash into a specific PCR (22 or 23) using TPM2_PCR_Extend. The</text><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="412.1729">ZTA reads and stores the resulting PCR value as a reference</text><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="423.8135">measurement or baseline. At every start of the PS, the ZTA measures</text><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="435.4541">the PS software and extends the resulting hash into the same PCR</text><text fill="#000000" font-family="Helvetica" font-size="10" x="380.5781" y="447.0947">(22 or 23) using TPM2_PCR_Extend.</text><path d="M348.5781,463.4531 L408.5342,463.4531 L408.5342,467.0938 L398.5342,477.0938 L348.5781,477.0938 L348.5781,463.4531" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="199.7656" style="stroke:#000000;stroke-width:1.5;" width="361.5029" x="348.5781" y="463.4531"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="363.5781" y="473.7354">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="423.5342" y="474.7354">[ZETA TPM Service has no TPM Attestation Key]</text><polygon fill="#181818" points="588.1807,512.375,598.1807,516.375,588.1807,520.375,592.1807,516.375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="369.5781" x2="594.1807" y1="516.375" y2="516.375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="376.5781" y="506.1963">(06)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="500.376">Generate Attestation Key Pair (AK)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="512.0166">and Get AK Handle</text><polygon fill="#181818" points="380.5781,549.6563,370.5781,553.6563,380.5781,557.6563,376.5781,553.6563" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="374.5781" x2="599.1807" y1="553.6563" y2="553.6563"/><text fill="#000000" font-family="Helvetica" font-size="10" x="386.5781" y="543.4775">(07)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="411.1055" y="537.6572">Return Attestation Public Key</text><text fill="#000000" font-family="Helvetica" font-size="10" x="411.1055" y="549.2979">and AK Handle</text><polygon fill="#181818" points="588.1807,575.2969,598.1807,579.2969,588.1807,583.2969,592.1807,579.2969" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="369.5781" x2="594.1807" y1="579.2969" y2="579.2969"/><text fill="#000000" font-family="Helvetica" font-size="10" x="376.5781" y="574.9385">(08)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="574.9385">Get Certificate Chain</text><polygon fill="#181818" points="380.5781,600.9375,370.5781,604.9375,380.5781,608.9375,376.5781,604.9375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="374.5781" x2="599.1807" y1="604.9375" y2="604.9375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="386.5781" y="600.5791">(09)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="411.1055" y="600.5791">Return Certificate Chain</text><line style="stroke:#181818;stroke-width:1;" x1="369.5781" x2="411.5781" y1="642.2188" y2="642.2188"/><line style="stroke:#181818;stroke-width:1;" x1="411.5781" x2="411.5781" y1="642.2188" y2="655.2188"/><line style="stroke:#181818;stroke-width:1;" x1="370.5781" x2="411.5781" y1="655.2188" y2="655.2188"/><polygon fill="#181818" points="380.5781,651.2188,370.5781,655.2188,380.5781,659.2188,376.5781,655.2188" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="376.5781" y="632.04">(10)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="626.2197">Store AK Handle, AK Public Key</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="637.8604">and Certificate Chain</text><line style="stroke:#181818;stroke-width:1;" x1="369.5781" x2="411.5781" y1="694.8594" y2="694.8594"/><line style="stroke:#181818;stroke-width:1;" x1="411.5781" x2="411.5781" y1="694.8594" y2="707.8594"/><line style="stroke:#181818;stroke-width:1;" x1="370.5781" x2="411.5781" y1="707.8594" y2="707.8594"/><polygon fill="#181818" points="380.5781,703.8594,370.5781,707.8594,380.5781,711.8594,376.5781,707.8594" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="376.5781" y="690.501">(11)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="690.501">Select AK Handle</text><polygon fill="#181818" points="588.1807,776.0625,598.1807,780.0625,588.1807,784.0625,592.1807,780.0625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="369.5781" x2="594.1807" y1="780.0625" y2="780.0625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="376.5781" y="752.4229">(12)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="729.1416">Get TPM Quote for PCRs</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="740.7822">(4, 5, 7, 10, 11, 22 or 23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="752.4229">and `attestation_challenge`</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="764.0635">(as qualifyingData),</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="775.7041">signed with AK</text><path d="M88.1777,720.8594 L88.1777,764.8594 L359.1777,764.8594 L359.1777,730.8594 L349.1777,720.8594 L88.1777,720.8594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M349.1777,720.8594 L349.1777,730.8594 L359.1777,730.8594 L349.1777,720.8594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="94.1777" y="735.1416">Binding: `attestation_challenge` enth&#228;lt Hash des</text><text fill="#000000" font-family="Helvetica" font-size="10" x="94.1777" y="746.7822">Client Instance Public Keys und die Nonce.</text><text fill="#000000" font-family="Helvetica" font-size="10" x="94.1777" y="758.4229">Das TPM signiert PCRs + `attestation_challenge`.</text><path d="M615.1807,720.8594 L615.1807,799.8594 L855.1807,799.8594 L855.1807,730.8594 L845.1807,720.8594 L615.1807,720.8594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M845.1807,720.8594 L845.1807,730.8594 L855.1807,730.8594 L845.1807,720.8594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="621.1807" y="735.1416">PCR 4: Boot Loader Code, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="621.1807" y="746.7822">PCR 5: Boot Loader Configuration, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="621.1807" y="758.4229">PCR 7: Secure Boot State / Policy, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="621.1807" y="770.0635">PCR   10:OS Kernel / IMA, Digest</text><text fill="#000000" font-family="Helvetica" font-size="10" x="621.1807" y="781.7041">PCR 11: OS Components / VSM, Digest,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="621.1807" y="793.3447">PCR 22 or 23 (if available) App Data, Digest</text><polygon fill="#181818" points="380.5781,819.3438,370.5781,823.3438,380.5781,827.3438,376.5781,823.3438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="374.5781" x2="599.1807" y1="823.3438" y2="823.3438"/><text fill="#000000" font-family="Helvetica" font-size="10" x="386.5781" y="818.9854">(13)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="411.1055" y="818.9854">Return TPM Quote</text><line style="stroke:#181818;stroke-width:1;" x1="369.5781" x2="411.5781" y1="848.9844" y2="848.9844"/><line style="stroke:#181818;stroke-width:1;" x1="411.5781" x2="411.5781" y1="848.9844" y2="861.9844"/><line style="stroke:#181818;stroke-width:1;" x1="370.5781" x2="411.5781" y1="861.9844" y2="861.9844"/><polygon fill="#181818" points="380.5781,857.9844,370.5781,861.9844,380.5781,865.9844,376.5781,861.9844" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="376.5781" y="844.626">(14)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="401.1055" y="844.626">Get TCG Event Log (from OS/Firmware)</text><path d="M610.1807,836.3438 L610.1807,892.3438 L854.1807,892.3438 L854.1807,846.3438 L844.1807,836.3438 L610.1807,836.3438" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M844.1807,836.3438 L844.1807,846.3438 L854.1807,846.3438 L844.1807,836.3438" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="616.1807" y="850.626">Quote contains:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="616.1807" y="862.2666">- `attestation_challenge` (as qualifyingData)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="616.1807" y="873.9072">- Attested Data (PCR Select, PCR Digest),</text><text fill="#000000" font-family="Helvetica" font-size="10" x="616.1807" y="885.5479">- Signature</text><polygon fill="#181818" points="100.293,923.1875,90.293,927.1875,100.293,931.1875,96.293,927.1875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="94.293" x2="358.5781" y1="927.1875" y2="927.1875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="917.0088">(15)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="911.1885">Return Attestation</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="922.8291">(Quote, EventLog, CertChain)</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="964.4688" y2="964.4688"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="964.4688" y2="977.4688"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="977.4688" y2="977.4688"/><polygon fill="#181818" points="100.293,973.4688,90.293,977.4688,100.293,981.4688,96.293,977.4688" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="954.29">(16)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="948.4697">Create client_statement</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="960.1104">with posture-tpm</text><path d="M253.3965,940.1875 L253.3965,1019.1875 L462.3965,1019.1875 L462.3965,950.1875 L452.3965,940.1875 L253.3965,940.1875" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M452.3965,940.1875 L452.3965,950.1875 L462.3965,950.1875 L452.3965,940.1875" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="954.4697">client_statement includes:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="966.1104">- sub</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="977.751">- product_id</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="989.3916">- product_version</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1001.0322">- posture (containing TPM Quote etc.)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1012.6729">- attestation-info</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1042.6719" y2="1042.6719"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1042.6719" y2="1055.6719"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1055.6719" y2="1055.6719"/><polygon fill="#181818" points="100.293,1051.6719,90.293,1055.6719,100.293,1059.6719,96.293,1055.6719" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1038.3135">(17)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1038.3135">Create Client Assertion JWT</text><path d="M270.3789,1030.0313 L270.3789,1179.0313 L572.3789,1179.0313 L572.3789,1040.0313 L562.3789,1030.0313 L270.3789,1030.0313" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M562.3789,1030.0313 L562.3789,1040.0313 L572.3789,1040.0313 L562.3789,1030.0313" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="276.3789" y="1044.3135">Client Assertion JWT Claims (with Attestation):</text><text fill="#000000" font-family="Helvetica" font-size="10" x="276.3789" y="1055.9541">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1067.5947">"iss": "&lt;client_id&gt;", "sub": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1079.2354">"aud": "&lt;AS_Token_Endpoint_URL&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1090.876">"exp": ..., "jti": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1102.5166">// Embed the client_statement with attestation</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1114.1572">"urn:gematik:params:oauth:client-attestation:tpm2": {</text><text fill="#000000" font-family="Helvetica" font-size="10" x="292.2725" y="1125.7979">"attestation_data": "&lt;Base64(client_statement)&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="292.2725" y="1137.4385">"client_statement_format": "client-statement"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="285.915" y="1149.0791">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="276.3789" y="1160.7197">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="276.3789" y="1172.3604">(sig by Client_Instance_Private_Key)</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1243.6406" y2="1243.6406"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1243.6406" y2="1256.6406"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1256.6406" y2="1256.6406"/><polygon fill="#181818" points="100.293,1252.6406,90.293,1256.6406,100.293,1260.6406,96.293,1256.6406" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1233.4619">(18)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1227.6416">Create client_statement</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1239.2822">with posture-software</text><path d="M253.3965,1219.3594 L253.3965,1298.3594 L515.3965,1298.3594 L515.3965,1229.3594 L505.3965,1219.3594 L253.3965,1219.3594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M505.3965,1219.3594 L505.3965,1229.3594 L515.3965,1229.3594 L505.3965,1219.3594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1233.6416">client_statement includes:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1245.2822">- sub</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1256.9229">- product_id</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1268.5635">- product_version</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1280.2041">- posture (containing attestation_challenge etc.)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="259.3965" y="1291.8447">- attestation-info</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1321.8438" y2="1321.8438"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1321.8438" y2="1334.8438"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1334.8438" y2="1334.8438"/><polygon fill="#181818" points="100.293,1330.8438,90.293,1334.8438,100.293,1338.8438,96.293,1334.8438" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1317.4854">(19)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1317.4854">Create Client Assertion JWT</text><path d="M270.3789,1309.2031 L270.3789,1458.2031 L589.3789,1458.2031 L589.3789,1319.2031 L579.3789,1309.2031 L270.3789,1309.2031" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M579.3789,1309.2031 L579.3789,1319.2031 L589.3789,1319.2031 L579.3789,1309.2031" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="276.3789" y="1323.4854">Client Assertion JWT Claims (with Attestation):</text><text fill="#000000" font-family="Helvetica" font-size="10" x="276.3789" y="1335.126">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1346.7666">"iss": "&lt;client_id&gt;", "sub": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1358.4072">"aud": "&lt;AS_Token_Endpoint_URL&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1370.0479">"exp": ..., "jti": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1381.6885">// Embed the client_statement</text><text fill="#000000" font-family="Helvetica" font-size="10" x="282.7363" y="1393.3291">"urn:gematik:params:oauth:client-attestation:software": {</text><text fill="#000000" font-family="Helvetica" font-size="10" x="292.2725" y="1404.9697">"attestation_data": "&lt;Base64(client_statement)&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="292.2725" y="1416.6104">"client_statement_format": "client-statement"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="285.915" y="1428.251">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="276.3789" y="1439.8916">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="276.3789" y="1451.5322">(sig by Client_Instance_Private_Key)</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1495.5313" y2="1495.5313"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1495.5313" y2="1508.5313"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1508.5313" y2="1508.5313"/><polygon fill="#181818" points="100.293,1504.5313,90.293,1508.5313,100.293,1512.5313,96.293,1508.5313" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1491.1729">(20)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1491.1729">Create "SM(C)-B ID Token" (JWT)</text><path d="M296.3164,1482.8906 L296.3164,1608.8906 L729.3164,1608.8906 L729.3164,1492.8906 L719.3164,1482.8906 L296.3164,1482.8906" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M719.3164,1482.8906 L719.3164,1492.8906 L729.3164,1492.8906 L719.3164,1482.8906" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="302.3164" y="1497.1729">SM(C)-B ID Token Claims:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="302.3164" y="1508.8135">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="308.6738" y="1520.4541">"iss": "&lt;client_id&gt;", // Issuer is the client</text><text fill="#000000" font-family="Helvetica" font-size="10" x="308.6738" y="1532.0947">"nonce": "&lt;nonce from AS&gt;", // Binding to AS</text><text fill="#000000" font-family="Helvetica" font-size="10" x="308.6738" y="1543.7354">"sub": "&lt;Telematik-ID from SM(C)-B&gt;", // Subject is the institution</text><text fill="#000000" font-family="Helvetica" font-size="10" x="308.6738" y="1555.376">"aud": "[&lt;Resource_Server_Endpoint_URL&gt;]", // Audience is the Resource Server</text><text fill="#000000" font-family="Helvetica" font-size="10" x="308.6738" y="1567.0166">"exp": ..., // Short-lived</text><text fill="#000000" font-family="Helvetica" font-size="10" x="308.6738" y="1578.6572">"iat": ...,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="308.6738" y="1590.2979">"jti": "..."</text><text fill="#000000" font-family="Helvetica" font-size="10" x="302.3164" y="1601.9385">}</text><polygon fill="#181818" points="664.9907,1627.9375,674.9907,1631.9375,664.9907,1635.9375,668.9907,1631.9375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="670.9907" y1="1631.9375" y2="1631.9375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1627.5791">(21)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1627.5791">externalAuthenticate (JWT-hash)</text><polygon fill="#181818" points="774.187,1653.5781,784.187,1657.5781,774.187,1661.5781,778.187,1657.5781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="686.9907" x2="780.187" y1="1657.5781" y2="1657.5781"/><text fill="#000000" font-family="Helvetica" font-size="10" x="693.9907" y="1653.2197">(22)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="718.5181" y="1653.2197">sign (hash)</text><polygon fill="#181818" points="697.9907,1679.2188,687.9907,1683.2188,697.9907,1687.2188,693.9907,1683.2188" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="691.9907" x2="785.187" y1="1683.2188" y2="1683.2188"/><text fill="#000000" font-family="Helvetica" font-size="10" x="703.9907" y="1678.8604">(23)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="728.5181" y="1678.8604">Signature</text><polygon fill="#181818" points="100.293,1704.8594,90.293,1708.8594,100.293,1712.8594,96.293,1708.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="94.293" x2="675.9907" y1="1708.8594" y2="1708.8594"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="1704.501">(24)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="1704.501">JWT-signature</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1734.5" y2="1734.5"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1734.5" y2="1747.5"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1747.5" y2="1747.5"/><polygon fill="#181818" points="100.293,1743.5,90.293,1747.5,100.293,1751.5,96.293,1747.5" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1730.1416">(25)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1730.1416">Add JWT-Signature to SM(C)-B ID Token</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="1773.1406" y2="1773.1406"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="1773.1406" y2="1786.1406"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="1786.1406" y2="1786.1406"/><polygon fill="#181818" points="100.293,1782.1406,90.293,1786.1406,100.293,1790.1406,96.293,1786.1406" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1768.7822">(26)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1768.7822">Create DPoP Proof JWT for Token Exchange</text><path d="M349.3584,1760.5 L349.3584,1909.5 L627.3584,1909.5 L627.3584,1770.5 L617.3584,1760.5 L349.3584,1760.5" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M617.3584,1760.5 L617.3584,1770.5 L627.3584,1770.5 L617.3584,1760.5" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="355.3584" y="1774.7822">DPoP Proof JWT Claims (for Token Exchange):</text><text fill="#000000" font-family="Helvetica" font-size="10" x="355.3584" y="1786.4229">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1798.0635">"typ": "dpop+jwt",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1809.7041">"alg": "ES256",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1821.3447">"jwk": { ... }</text><text fill="#000000" font-family="Helvetica" font-size="10" x="355.3584" y="1832.9854">}.{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1844.626">"jti": "...",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1856.2666">"htm": "POST",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1867.9072">"htu": "&lt;AS_Token_Endpoint_URL&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1879.5479">"nonce": "&lt;nonce from AS&gt;", // Binding to AS</text><text fill="#000000" font-family="Helvetica" font-size="10" x="361.7158" y="1891.1885">"iat": ...</text><text fill="#000000" font-family="Helvetica" font-size="10" x="355.3584" y="1902.8291">}.(sig by DPoP_Private_Key)</text><polygon fill="#181818" points="879.7764,1928.8281,889.7764,1932.8281,879.7764,1936.8281,883.7764,1932.8281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="885.7764" y1="1932.8281" y2="1932.8281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="1928.4697">(27)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="1928.4697">POST /token (RFC 8693) DPoP: &lt;signed_dpop_jwt&gt;</text><path d="M94.293,1945.8281 L94.293,2059.8281 L507.293,2059.8281 L507.293,1955.8281 L497.293,1945.8281 L94.293,1945.8281" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M497.293,1945.8281 L497.293,1955.8281 L507.293,1955.8281 L497.293,1945.8281" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="100.293" y="1960.1104">Token Exchange Request Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="1971.751">grant_type=urn:ietf:params:oauth:grant-type:token-exchange</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="1983.3916">&amp;subject_token=&lt;SM(C)-B signed ID Token&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="1995.0322">&amp;subject_token_type=urn:ietf:params:oauth:token-type:jwt</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2006.6729">&amp;client_assertion_type=urn:ietf:params:oauth:client-assertion-type:jwt-bearer</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2018.3135">&amp;client_assertion=&lt;Client_Assertion_JWT&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2029.9541">&amp;audience=&lt;Resource Server Endpoint&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2041.5947">&amp;scope=&lt;Resource Server scopes&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2053.2354">...</text><line style="stroke:#181818;stroke-width:1;" x1="901.7764" x2="943.7764" y1="2106.5156" y2="2106.5156"/><line style="stroke:#181818;stroke-width:1;" x1="943.7764" x2="943.7764" y1="2106.5156" y2="2119.5156"/><line style="stroke:#181818;stroke-width:1;" x1="902.7764" x2="943.7764" y1="2119.5156" y2="2119.5156"/><polygon fill="#181818" points="912.7764,2115.5156,902.7764,2119.5156,912.7764,2123.5156,908.7764,2119.5156" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="908.7764" y="2090.5166">(28)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2078.876">Validate Request (Client Assertion,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2090.5166">Attestation, DPoP Proof,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2102.1572">Subject Token)</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="2174.7969" y2="2174.7969"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="2174.7969" y2="2187.7969"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="2187.7969" y2="2187.7969"/><polygon fill="#181818" points="100.293,2183.7969,90.293,2187.7969,100.293,2191.7969,96.293,2187.7969" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="2170.4385">(29)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="2170.4385">Create Client Assertion JWT without Attestation</text><path d="M369.5781,2162.1563 L369.5781,2276.1563 L672.5781,2276.1563 L672.5781,2172.1563 L662.5781,2162.1563 L369.5781,2162.1563" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M662.5781,2162.1563 L662.5781,2172.1563 L672.5781,2172.1563 L662.5781,2162.1563" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="375.5781" y="2176.4385">Client Assertion JWT Claims (without Attestation):</text><text fill="#000000" font-family="Helvetica" font-size="10" x="375.5781" y="2188.0791">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="381.9355" y="2199.7197">"iss": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="381.9355" y="2211.3604">"sub": "&lt;client_id&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="381.9355" y="2223.001">"aud": "&lt;AS_Token_Endpoint_URL&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="381.9355" y="2234.6416">"exp": ...,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="381.9355" y="2246.2822">"jti": "..."</text><text fill="#000000" font-family="Helvetica" font-size="10" x="375.5781" y="2257.9229">}</text><text fill="#000000" font-family="Helvetica" font-size="10" x="375.5781" y="2269.5635">(sig by Client_Instance_Private_Key)</text><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="131.293" y1="2299.5625" y2="2299.5625"/><line style="stroke:#181818;stroke-width:1;" x1="131.293" x2="131.293" y1="2299.5625" y2="2312.5625"/><line style="stroke:#181818;stroke-width:1;" x1="90.293" x2="131.293" y1="2312.5625" y2="2312.5625"/><polygon fill="#181818" points="100.293,2308.5625,90.293,2312.5625,100.293,2316.5625,96.293,2312.5625" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="2295.2041">(30)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="2295.2041">Create DPoP Proof JWT for Token Exchange</text><polygon fill="#181818" points="879.7764,2334.2031,889.7764,2338.2031,879.7764,2342.2031,883.7764,2338.2031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="89.293" x2="885.7764" y1="2338.2031" y2="2338.2031"/><text fill="#000000" font-family="Helvetica" font-size="10" x="96.293" y="2333.8447">(31)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="120.8203" y="2333.8447">POST /token DPoP: &lt;signed_dpop_jwt&gt;</text><path d="M94.293,2351.2031 L94.293,2419.2031 L507.293,2419.2031 L507.293,2361.2031 L497.293,2351.2031 L94.293,2351.2031" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><path d="M497.293,2351.2031 L497.293,2361.2031 L507.293,2361.2031 L497.293,2351.2031" fill="#ADD8E6" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="100.293" y="2365.4854">Token Exchange Request Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2377.126">grant_type=refresh_token</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2388.7666">&amp;refresh_token=&lt;Refresh_Token&gt;</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2400.4072">&amp;client_assertion_type=urn:ietf:params:oauth:client-assertion-type:jwt-bearer</text><text fill="#000000" font-family="Helvetica" font-size="10" x="100.293" y="2412.0479">&amp;client_assertion=&lt;Client_Assertion_JWT_</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="312.8564" y="2412.0479">without</text><text fill="#000000" font-family="Helvetica" font-size="10" x="356.1914" y="2412.0479">_Attestation&gt;</text><line style="stroke:#181818;stroke-width:1;" x1="901.7764" x2="943.7764" y1="2453.6875" y2="2453.6875"/><line style="stroke:#181818;stroke-width:1;" x1="943.7764" x2="943.7764" y1="2453.6875" y2="2466.6875"/><line style="stroke:#181818;stroke-width:1;" x1="902.7764" x2="943.7764" y1="2466.6875" y2="2466.6875"/><polygon fill="#181818" points="912.7764,2462.6875,902.7764,2466.6875,912.7764,2470.6875,908.7764,2466.6875" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="908.7764" y="2443.5088">(32)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2437.6885">Validate Request (Client Assertion,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2449.3291">DPoP Proof, Refresh Token)</text><line style="stroke:#181818;stroke-width:1;" x1="901.7764" x2="943.7764" y1="2492.3281" y2="2492.3281"/><line style="stroke:#181818;stroke-width:1;" x1="943.7764" x2="943.7764" y1="2492.3281" y2="2505.3281"/><line style="stroke:#181818;stroke-width:1;" x1="902.7764" x2="943.7764" y1="2505.3281" y2="2505.3281"/><polygon fill="#181818" points="912.7764,2501.3281,902.7764,2505.3281,912.7764,2509.3281,908.7764,2505.3281" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="908.7764" y="2487.9697">(33)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2487.9697">Invalidate Refresh token</text><polygon fill="#181818" points="1138.084,2526.9688,1148.084,2530.9688,1138.084,2534.9688,1142.084,2530.9688" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="901.7764" x2="1144.084" y1="2530.9688" y2="2530.9688"/><text fill="#000000" font-family="Helvetica" font-size="10" x="908.7764" y="2526.6104">(34)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2526.6104">Get Client Data, Session Data, User Data</text><polygon fill="#181818" points="912.7764,2552.6094,902.7764,2556.6094,912.7764,2560.6094,908.7764,2556.6094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="906.7764" x2="1149.084" y1="2556.6094" y2="2556.6094"/><text fill="#000000" font-family="Helvetica" font-size="10" x="918.7764" y="2552.251">(35)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="943.3037" y="2552.251">Client Data, Session Data, User Data</text><path d="M49.293,2582.6094 L109.249,2582.6094 L109.249,2586.25 L99.249,2596.25 L49.293,2596.25 L49.293,2582.6094" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="638.7813" style="stroke:#000000;stroke-width:1.5;" width="1207.9346" x="49.293" y="2582.6094"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="64.293" y="2592.8916">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="124.249" y="2593.8916">[Validations Successful]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="49.293" x2="1257.2275" y1="3177.1094" y2="3177.1094"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="54.293" y="3188.3916">[Validation Failed]</text><polygon fill="#181818" points="1219.2275,2631.5313,1229.2275,2635.5313,1219.2275,2639.5313,1223.2275,2635.5313" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="901.7764" x2="1225.2275" y1="2635.5313" y2="2635.5313"/><text fill="#000000" font-family="Helvetica" font-size="10" x="908.7764" y="2625.3525">(36)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2619.5322">POST /v1/data/authz, body</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2631.1729">{  "input": {...}}</text><path d="M1041.3604,2648.5313 L1041.3604,2774.5313 L1230.3604,2774.5313 L1230.3604,2658.5313 L1220.3604,2648.5313 L1041.3604,2648.5313" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><path d="M1220.3604,2648.5313 L1220.3604,2658.5313 L1230.3604,2658.5313 L1220.3604,2648.5313" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="1047.3604" y="2662.8135">Policy Engine Response Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1047.3604" y="2674.4541">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1053.7178" y="2686.0947">...</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1053.7178" y="2697.7354">"allow": true,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1053.7178" y="2709.376">"ttl": {</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1060.0752" y="2721.0166">"access_token": 300,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1060.0752" y="2732.6572">"refresh_token": 86400</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1053.7178" y="2744.2979">},</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1053.7178" y="2755.9385">...</text><text fill="#000000" font-family="Helvetica" font-size="10" x="1047.3604" y="2767.5791">}</text><polygon fill="#181818" points="912.7764,2793.5781,902.7764,2797.5781,912.7764,2801.5781,908.7764,2797.5781" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="906.7764" x2="1230.2275" y1="2797.5781" y2="2797.5781"/><text fill="#000000" font-family="Helvetica" font-size="10" x="918.7764" y="2793.2197">(37)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="943.3037" y="2793.2197">200 OK</text><path d="M68.293,2809.5781 L128.249,2809.5781 L128.249,2813.2188 L118.249,2823.2188 L68.293,2823.2188 L68.293,2809.5781" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="342.5313" style="stroke:#000000;stroke-width:1.5;" width="1107.791" x="68.293" y="2809.5781"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="83.293" y="2819.8604">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="143.249" y="2820.8604">[Policy Decision allowed]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="68.293" x2="1176.084" y1="3107.8281" y2="3107.8281"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="73.293" y="3119.1104">[Policy Decision denied]</text><line style="stroke:#181818;stroke-width:1;" x1="901.7764" x2="943.7764" y1="2862.5" y2="2862.5"/><line style="stroke:#181818;stroke-width:1;" x1="943.7764" x2="943.7764" y1="2862.5" y2="2875.5"/><line style="stroke:#181818;stroke-width:1;" x1="902.7764" x2="943.7764" y1="2875.5" y2="2875.5"/><polygon fill="#181818" points="912.7764,2871.5,902.7764,2875.5,912.7764,2879.5,908.7764,2875.5" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="908.7764" y="2852.3213">(38)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2846.501">Generate AS Access Token (AT)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2858.1416">and Refresh Token (RT)</text><polygon fill="#181818" points="1138.084,2920.4219,1148.084,2924.4219,1138.084,2928.4219,1142.084,2924.4219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="901.7764" x2="1144.084" y1="2924.4219" y2="2924.4219"/><text fill="#000000" font-family="Helvetica" font-size="10" x="908.7764" y="2908.4229">(39)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2896.7822">Update Client Data</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2908.4229">Update Session</text><text fill="#000000" font-family="Helvetica" font-size="10" x="933.3037" y="2920.0635">Update User Data</text><polygon fill="#181818" points="912.7764,2946.0625,902.7764,2950.0625,912.7764,2954.0625,908.7764,2950.0625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="906.7764" x2="1149.084" y1="2950.0625" y2="2950.0625"/><text fill="#000000" font-family="Helvetica" font-size="10" x="918.7764" y="2945.7041">(40)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="943.3037" y="2945.7041">updated</text><polygon fill="#181818" points="100.293,2971.7031,90.293,2975.7031,100.293,2979.7031,96.293,2975.7031" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="94.293" x2="890.7764" y1="2975.7031" y2="2975.7031"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="2971.3447">(41)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="2971.3447">200 OK, new tokens</text><path d="M615.8057,2988.7031 L615.8057,3091.7031 L890.8057,3091.7031 L890.8057,2998.7031 L880.8057,2988.7031 L615.8057,2988.7031" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><path d="M880.8057,2988.7031 L880.8057,2998.7031 L890.8057,2998.7031 L880.8057,2988.7031" fill="#90EE90" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="621.8057" y="3002.9854">Token Response Body:</text><text fill="#000000" font-family="Helvetica" font-size="10" x="621.8057" y="3014.626">{</text><text fill="#000000" font-family="Helvetica" font-size="10" x="628.1631" y="3026.2666">"access_token": "&lt;AS_Access_Token&gt;",</text><text fill="#000000" font-family="Helvetica" font-size="10" x="628.1631" y="3037.9072">"token_type": "DPoP", // Indicate DPoP is required</text><text fill="#000000" font-family="Helvetica" font-size="10" x="628.1631" y="3049.5479">"expires_in": 300,</text><text fill="#000000" font-family="Helvetica" font-size="10" x="628.1631" y="3061.1885">"refresh_token": "&lt;AS_Refresh_Token&gt;"</text><text fill="#000000" font-family="Helvetica" font-size="10" x="628.1631" y="3072.8291">// ... other parameters</text><text fill="#000000" font-family="Helvetica" font-size="10" x="621.8057" y="3084.4697">}</text><polygon fill="#181818" points="100.293,3140.1094,90.293,3144.1094,100.293,3148.1094,96.293,3144.1094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="94.293" x2="890.7764" y1="3144.1094" y2="3144.1094"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="3139.751">(42)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="3139.751">403 Forbidden</text><polygon fill="#181818" points="100.293,3209.3906,90.293,3213.3906,100.293,3217.3906,96.293,3213.3906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="94.293" x2="890.7764" y1="3213.3906" y2="3213.3906"/><text fill="#000000" font-family="Helvetica" font-size="10" x="106.293" y="3209.0322">(43)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="130.8203" y="3209.0322">400 Bad Request</text><!--SRC=[xLhzSjl64VyVJx5bPXgI9YLP_aZAiJn3KPIiIfPOaKdQb1tc21p9iy433Hmaonw_JTuaBzRTkmDm047BIPjsfjEPP0G2ktlxyTlVxG5cgOfakfxp61hDWuDMmqlU2hbXCLj3m1Si3TLf9DLOVE3m-A3-uHLRStZ5mrkkXCyScHCZypgIKR9XFWzowK6KneB7Zcp8vLAj-i6RD54W8ycTPmb_btBfynk-u35T73F_xJAEKXaCeZ2AuOULKAx2kAfGn73exN_zaA2w3pdCep3mljxtl3ziOhPSCr0y-W0gJhddzNs5gtwNO0Jpw3qqBeVd3VZgR1KbohW2eE-FOh7-vUSukKyKNwF49RlbCa0j02lnut3IXq4ek5JuVCnaS7ySHtTIIm2WbvXJiM5IMIbWYT6QIgkcHT4i6VIgIZ_snxa6z9NYYM9AH18ZZs-5pwUosG_MGa8ibYkLj1fR5YQZrze2_gM7nKAkq4Ka9NzBII7HubSKJ-Nal7l65BzZzusArlZriPOVlsuEMjtZXfSPDrdjoxdWYiUOcCbmyEhg-lBwx6-UcxYpbCN1TjxSDVgfMfaKZ4v6Kqa_erXyA9A0zhUKKFJak50wOOhDMS9h18U5r2WAXNyFGxaKahkfogEo5NpqABlglhJ-FNe4FJWRJc0VeUzppzpjulDCijk3cAiqbd1uS03N5o3vNLSBzy3eU5_3qT4HZ2VzcqaF9jSNmoiO_dNmgdzrDeJnS30vlxuY2O-52iwbK8A5O5CFa-Wjbp1yxw-ONF8xeLOkMZ2OmcDxrOD1pB6kS3AAHd31xs74H0pD1PQzRAs5wZ92IOsn7cOzIT1ebr8Q59gag6tDXGo4NEvvDSlYgYpqqv0MPeM3Crmf90hXbRKcgnro819WuCVt6nKjOxPP2HzMB5bDPRG0XLgZT8xrp1mubsW1iwpTVOLoW9130phrUrDvhiXWIW6fI4UWZJXBqtswvHk3mXf4tNh_Zk1LV_ogkKddkAHUyP5PZTA9_vMgtPzCXdYfI-oM6e2AlQlvWTqo4R9vo3MmYrmJQnX8SkKgJgL6na-r7l-aZUJh4Mzaws1YqNTzotK30xCyLorPYJYXEHgtTBufVpk3QVuuwQDOZ9o6V4QY2MqroDYuemJHcWcvXuhwYHBu10lj5YCCjRsEMOK8re_McnGNgWKAP3WPGn8jr1qkh7taxnKsV8BFH3ALMb98h3s3PCDziK3rqU06ceU7o8vm-AI5g46qKt8EP_XaDjG6zYWFKub-ODypj4Us4-HKdkXbyIzkhQH8rcvPc7AY8eOFx5OsbMlEaZJcQmeHrw9-2v6RT1Ou4jyz6aGoAoB9OmUhYX5yFaRNaIBMFFde6-um3uLgGK2eG_0HIYpu98-fqIkOiKJJlsXXxw0t6gGNs9Koi4W6RQHhaDo36qEShXdRtMZDsAZg5xwO9XXm97si7RapM26KFhFEBbbhKukEgPB5gXswhFfKRuTs4smopziooKFkLpDHZOFy_KjAtKPqYpN02ZUVTk1P1xxfu8I7_p_kG5umuyYEVaTDHDoxb8LYSOzrfMsorPdAH2mbyg3PH2wylBz3li3sFZRitjjb5GDKgrz-HXhHf1SG1giaN6GAEHST30I7Ayl49-WJHKbUu8YfT938dJkMs_Eg_4Fzz1JzZ285bn73SGt7rG1BT2AMQ00tUXHuLXMG2x5COyiWhkGtL1aVUyaeZ1MLSn_Cj50M1In0xtgCSSMIXoXq_hfVbdZyk0SeC41YmX5PgWI5lX-_peGwHYeh7pJ5ek3u5lGt6w0YPU9U1S5woh0Wpe6oXJCDey4P36-f9fVH4lVyE5gZN_kd8buJIRIsacemv-DqZJXEUbFPtLd_6b2HkEbUn1NTmIq1upI8x-YAcOW8VbqOO-aPHk7uNfwajWa1iQnTx9YmCAgExZ_TTwtAzfYF8cO0Cfl8Z2nfhhMxv0PF0-X3LstMM-cegY1j-c6AMDUPIT8v_Td4KP3wQYO2znVoTg8TxcOhGDFcrNAhJJPN_fxEd9Fdhf2Bg3QQOfwpl_j9Glo3NFdd7oQL0E2haFxCSTEnt0RGRjSfeZKcrWaqgoDbgzTkvxeVyok0XaYIHWyQBsoEHF2oqO46vcJhhgl5qa0_xuzdUlgS3MMmYN0tcdrtSrcHvUytABktjuTstoX1UlYZ9BE_3qCy5GVEoEPKImV3IlDnRXo1rLloDTv_szE7pAGNCHpdUyPArr7h8JGESNKtV1sBqnW1ebq7Teoxz_EdpQelhN9if5uLcI7LepzanVgGFsgugf-yxQicqYZCxoqePXa3pt10kqKRCwJWLhujIKCNF4mud68_p_6OZknd9mUQzucGi_qShrEv_9TQAnjA_eFzLJ-i_x_NVgzU-wsjbK7ZVx2zx02O7G67LoUx3u3LWs9stZy_iOTq3KG2a3akxePgewhQW2Q2hdoutmPhkxszf8PfWScYFlLuH7oS9qcAOvP878mKMlfOhFNq5UXnf3-skdRWfFDtVrmePI2Vu12X8TL51xMcTTYgZzFv6vghxTfqL1GgBR5-rX1_Vt73aoYDiO3cpLAvCVvX3FPJ75V9JMinqx5lexowrY4_Lb6ikg6uvO6JBuqx4YdkELtc5NZB0LGgSl6cJf-uw5mNInRIwoUKC4SFgdANpdPKwa81jUdzdTQZMHkQcGpTxfQCTxiev4vbxYDdCaCfMYnn96i0sGy2BPORfD9MKUOz_Cvg54TuyYNYt7vdzI2gAnOowgrv-rKBT7LFjMqWEZQFtjmfXsGQB5pIe-7uyDbpz_wRkxT4PbJjd44-xNsiBRoZjb9hkZkw7a_AjzClu_3VrbqvC7D7CwgZn5NvpM4tXzC-prMb-ZflKIbGs5TQeNbpEe1ld__fIKilsuCNvcmwexpFCEylgvijbjDQhTIytIwN5TlsNOhR29xgWlkinCkOOGAnjlo8zYh1rQAyKMc1BWdqj8TTNk0Du8-9uPgPVdRq8ak0FL1dUNXP8_ovHSrAUb4CsIXRWcNP_F0v_MntpMHpKzqvnnqshhTuzC9kQlcCCiD6iRupou57Bohi1naCio3zQ5CZfMydHYO3cGCY-_eymqKFliVZP42DdrMjMHsWyE3eJ4mTXo7mIRO7wFItF4zFk3Ty4VDaPR6PuXqzU4LfwPLfo_kryn_KM7cGZXwS1wjkVV7skxrZrZ_zug7GsTSUshH-nOXKlx_zUjxVffKofUpcaT-3HMA3CTFZfYDAjwWpp4-N6VvRpJrhjotKsksP0xQNth-XEvs6BBTUQyja3yxbRM7Jo6Ofp4NDHxxyCuTTqhmViv-ex2_wqAilKTreTNFlwNNI5wbcOxkpmNtc6nsAkMFxz_tByvFjwPu-jjZauP89pgg-Zyilqh0KwD3T6MyVxzEXPv-g_w43SmJUL7wavfURb3RjZzY4dpwLNziIej6CGVCovXQCxNRfeoUDiXlqWvVWdF5BCGpWY1D6TxWKVKtFIA2XL5Wwh3MO3iO07PyyEJXm2AFK1lZqs-TF3muowkXKblnKtI0mbd89pKTL-xtC1dN2VQ5BgTsrO_SMU8kl56FeQuyjfJJx4_l-lBnJD6ychR8f1udVRG9dNo3WJAMzPu6L_tPHMO_BL0kM_7PUiPYGE_GXsJH7acUtL7UZMIszosQrPTzwrr0ffzufJC8iUPLV71HZ3GbJzzkZ8CwRVixbU8QAaJH4x9oAp1Q3jvAPs09E3NIq9sKURPHVJz387U6HA0RDdVIF4fBAQRxw_gkAeO1BiRCKJm-Um6aKpqKGwFHcNA4j5GqEfqo4saZDlmy0CdC0nop8QBIESdOGIVuF4hh_1000]--></g></svg>