<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="808px" preserveAspectRatio="none" style="width:782px;height:808px;background:#FFFFFF;" version="1.1" viewBox="0 0 782 808" width="782px" zoomAndPan="magnify"><defs/><g><rect fill="#F8F8FF" height="796.0156" style="stroke:#181818;stroke-width:0.5;" width="102.1934" x="39.793" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="82.4277" y="15.2822">LEI</text><rect fill="#E6E6FA" height="779.375" style="stroke:#181818;stroke-width:0.5;" width="102.1934" x="39.793" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="51.793" y="31.9229">Prim&#228;rsystem</text><rect fill="#F4A460" height="762.7344" style="stroke:#181818;stroke-width:0.5;" width="102.1934" x="39.793" y="39.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="58.3896" y="48.5635">ZETA Client</text><rect fill="#C9FFC9" height="796.0156" style="stroke:#181818;stroke-width:0.5;" width="205.9902" x="486.3369" y="6"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="527.4399" y="15.2822">Anbieter TI 2.0 Dienst</text><rect fill="#F4A460" height="779.375" style="stroke:#181818;stroke-width:0.5;" width="205.9902" x="486.3369" y="22.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="556.1875" y="31.9229">ZETA Guard</text><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="597.8125" width="8" x="15.8965" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="19.3965" x2="19.3965" y1="126.5625" y2="724.375"/></g><g><title>ZETA</title><rect fill="#000000" fill-opacity="0.00000" height="597.8125" width="8" x="87.3896" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="90.8896" x2="90.8896" y1="126.5625" y2="724.375"/></g><g><title/><rect fill="#FFFFFF" height="518.8906" style="stroke:#181818;stroke-width:1;" width="10" x="85.8896" y="205.4844"/></g><g><title>PEP</title><rect fill="#000000" fill-opacity="0.00000" height="597.8125" width="8" x="522.3574" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="525.8574" x2="525.8574" y1="126.5625" y2="724.375"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="520.8574" y="223.125"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="520.8574" y="302.0469"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="520.8574" y="576.8125"/></g><g><title>PDP</title><rect fill="#000000" fill-opacity="0.00000" height="597.8125" width="8" x="626.3525" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="629.8525" x2="629.8525" y1="126.5625" y2="724.375"/></g><g><title/><rect fill="#FFFFFF" height="25.6406" style="stroke:#181818;stroke-width:1;" width="10" x="624.8525" y="628.0938"/></g><g><title>OpenID</title><rect fill="#000000" fill-opacity="0.00000" height="597.8125" width="8" x="738.7266" y="126.5625"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="742.2266" x2="742.2266" y1="126.5625" y2="724.375"/></g><g><title/><rect fill="#FFFFFF" height="76.9219" style="stroke:#181818;stroke-width:1;" width="10" x="737.2266" y="367.3281"/></g><text fill="#000000" font-family="Helvetica" font-size="10" x="5" y="124.2041">User</text><ellipse cx="19.3965" cy="63.4219" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M19.3965,71.4219 L19.3965,98.4219 M6.3965,79.4219 L32.3965,79.4219 M19.3965,98.4219 L6.3965,113.4219 M19.3965,98.4219 L32.3965,113.4219" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="69.4146" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="77.8306" y="104.5635">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="76.4146" y="116.2041">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.041" x="490.3369" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="516.668" y="104.5635">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="497.3369" y="116.2041">HTTP Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="571.3779" y="88.2813"/><text fill="#000000" font-family="Helvetica" font-size="10" x="619.9722" y="104.5635">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="578.3779" y="116.2041">Authorization Server</text><rect fill="#E2E2F0" height="48.9219" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="67.7988" x="708.3271" y="76.6406"/><text fill="#000000" font-family="Helvetica" font-size="10" x="723.5474" y="92.9229">OpenID</text><text fill="#000000" font-family="Helvetica" font-size="10" x="715.3271" y="104.5635">Federation</text><text fill="#000000" font-family="Helvetica" font-size="10" x="725.1514" y="116.2041">Master</text><text fill="#000000" font-family="Helvetica" font-size="10" x="5" y="793.6572">User</text><ellipse cx="19.3965" cy="732.875" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M19.3965,740.875 L19.3965,767.875 M6.3965,748.875 L32.3965,748.875 M19.3965,767.875 L6.3965,782.875 M19.3965,767.875 L32.3965,782.875" fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="42.9502" x="69.4146" y="724.375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="77.8306" y="740.6572">ZETA</text><text fill="#000000" font-family="Helvetica" font-size="10" x="76.4146" y="752.2979">Client</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.041" x="490.3369" y="724.375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="516.668" y="740.6572">PEP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="497.3369" y="752.2979">HTTP Proxy</text><rect fill="#E2E2F0" height="37.2813" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="116.9492" x="571.3779" y="724.375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="619.9722" y="740.6572">PDP</text><text fill="#000000" font-family="Helvetica" font-size="10" x="578.3779" y="752.2979">Authorization Server</text><rect fill="#E2E2F0" height="48.9219" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="67.7988" x="708.3271" y="724.375"/><text fill="#000000" font-family="Helvetica" font-size="10" x="723.5474" y="740.6572">OpenID</text><text fill="#000000" font-family="Helvetica" font-size="10" x="715.3271" y="752.2979">Federation</text><text fill="#000000" font-family="Helvetica" font-size="10" x="725.1514" y="763.9385">Master</text><path d="M95.8896,139.5625 L95.8896,172.5625 L521.8896,172.5625 L521.8896,149.5625 L511.8896,139.5625 L95.8896,139.5625" fill="#FFFFE0" style="stroke:#181818;stroke-width:0.5;"/><path d="M511.8896,139.5625 L511.8896,149.5625 L521.8896,149.5625 L511.8896,139.5625" fill="#FFFFE0" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="101.8896" y="153.8447">- ZETA Client is pre-configured with Federation Master issuer (Fed-Master-issuer)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="101.8896" y="165.4854">- ZETA Client is pre-configured with Resource Server FQDN (RS-FQDN)</text><path d="M55.8896,181.8438 L115.8457,181.8438 L115.8457,185.4844 L105.8457,195.4844 L55.8896,195.4844 L55.8896,181.8438" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="518.5313" style="stroke:#000000;stroke-width:1.5;" width="707.3369" x="55.8896" y="181.8438"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="70.8896" y="192.126">alt</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="130.8457" y="193.126">[Recommended Flow]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="55.8896" x2="763.2266" y1="540.5313" y2="540.5313"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="60.8896" y="551.8135">[Legacy Flow]</text><polygon fill="#181818" points="508.8574,219.125,518.8574,223.125,508.8574,227.125,512.8574,223.125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="95.8896" x2="514.8574" y1="223.125" y2="223.125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="102.8896" y="218.7666">(01)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="127.417" y="218.7666">GET /.well-known/api-catalog Host: RS-FQDN</text><polygon fill="#181818" points="106.8896,244.7656,96.8896,248.7656,106.8896,252.7656,102.8896,248.7656" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="100.8896" x2="519.8574" y1="248.7656" y2="248.7656"/><text fill="#000000" font-family="Helvetica" font-size="10" x="112.8896" y="244.4072">(02)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="137.417" y="244.4072">Client: 200 OK; JSON body with Well-Known JSON Document  (RFC9727)</text><path d="M74.8896,260.7656 L144.2158,260.7656 L144.2158,264.4063 L134.2158,274.4063 L74.8896,274.4063 L74.8896,260.7656" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="74.9219" style="stroke:#000000;stroke-width:1.5;" width="471.9678" x="74.8896" y="260.7656"/><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="89.8896" y="271.0479">loop</text><text fill="#000000" font-family="Helvetica" font-size="10" font-weight="bold" x="159.2158" y="272.0479">[for each resource-name in list of APIs]</text><polygon fill="#181818" points="508.8574,298.0469,518.8574,302.0469,508.8574,306.0469,512.8574,302.0469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="95.8896" x2="514.8574" y1="302.0469" y2="302.0469"/><text fill="#000000" font-family="Helvetica" font-size="10" x="102.8896" y="297.6885">(03)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="127.417" y="297.6885">GET /.well-known/oauth-protected-resource/resource-name   Host: RS-FQDN</text><polygon fill="#181818" points="106.8896,323.6875,96.8896,327.6875,106.8896,331.6875,102.8896,327.6875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="100.8896" x2="519.8574" y1="327.6875" y2="327.6875"/><text fill="#000000" font-family="Helvetica" font-size="10" x="112.8896" y="323.3291">(04)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="137.417" y="323.3291">Client: 200 OK; JSON body with Well-Known JSON Document  (RFC9728)</text><polygon fill="#181818" points="725.2266,363.3281,735.2266,367.3281,725.2266,371.3281,729.2266,367.3281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="95.8896" x2="731.2266" y1="367.3281" y2="367.3281"/><text fill="#000000" font-family="Helvetica" font-size="10" x="102.8896" y="362.9697">(05)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="127.417" y="362.9697">GET /federation/fetch?iss=&lt;Fed-Master-issuer&gt;&amp;  sub=&lt;ZETA-Guard-AS-issuer&gt;</text><polygon fill="#181818" points="106.8896,388.9688,96.8896,392.9688,106.8896,396.9688,102.8896,392.9688" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="100.8896" x2="736.2266" y1="392.9688" y2="392.9688"/><text fill="#000000" font-family="Helvetica" font-size="10" x="112.8896" y="388.6104">(06)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="137.417" y="388.6104">200 OK; JSON body with ZETA Guard AS Metadata</text><polygon fill="#181818" points="725.2266,414.6094,735.2266,418.6094,725.2266,422.6094,729.2266,418.6094" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="95.8896" x2="731.2266" y1="418.6094" y2="418.6094"/><text fill="#000000" font-family="Helvetica" font-size="10" x="102.8896" y="414.251">(07)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="127.417" y="414.251">GET /openid/v1/jwks</text><polygon fill="#181818" points="106.8896,440.25,96.8896,444.25,106.8896,448.25,102.8896,444.25" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="100.8896" x2="736.2266" y1="444.25" y2="444.25"/><text fill="#000000" font-family="Helvetica" font-size="10" x="112.8896" y="439.8916">(08)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="137.417" y="439.8916">200 OK; JSON body with JSON Web Key Set</text><line style="stroke:#181818;stroke-width:1;" x1="95.8896" x2="137.8896" y1="469.8906" y2="469.8906"/><line style="stroke:#181818;stroke-width:1;" x1="137.8896" x2="137.8896" y1="469.8906" y2="482.8906"/><line style="stroke:#181818;stroke-width:1;" x1="96.8896" x2="137.8896" y1="482.8906" y2="482.8906"/><polygon fill="#181818" points="106.8896,478.8906,96.8896,482.8906,106.8896,486.8906,102.8896,482.8906" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="102.8896" y="465.5322">(09)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="127.417" y="465.5322">Verify signature of fetched JSON Document</text><line style="stroke:#181818;stroke-width:1;" x1="95.8896" x2="137.8896" y1="508.5313" y2="508.5313"/><line style="stroke:#181818;stroke-width:1;" x1="137.8896" x2="137.8896" y1="508.5313" y2="521.5313"/><line style="stroke:#181818;stroke-width:1;" x1="96.8896" x2="137.8896" y1="521.5313" y2="521.5313"/><polygon fill="#181818" points="106.8896,517.5313,96.8896,521.5313,106.8896,525.5313,102.8896,521.5313" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="102.8896" y="504.1729">(10)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="127.417" y="504.1729">Update Configuration</text><polygon fill="#181818" points="508.8574,572.8125,518.8574,576.8125,508.8574,580.8125,512.8574,576.8125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="95.8896" x2="514.8574" y1="576.8125" y2="576.8125"/><text fill="#000000" font-family="Helvetica" font-size="10" x="102.8896" y="572.4541">(11)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="127.417" y="572.4541">GET /.well-known/oauth-protected-resource Host: RS-FQDN</text><polygon fill="#181818" points="106.8896,598.4531,96.8896,602.4531,106.8896,606.4531,102.8896,602.4531" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="100.8896" x2="519.8574" y1="602.4531" y2="602.4531"/><text fill="#000000" font-family="Helvetica" font-size="10" x="112.8896" y="598.0947">(12)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="137.417" y="598.0947">Client: 200 OK; JSON body with Well-Known JSON Document  (RFC9728)</text><polygon fill="#181818" points="612.8525,624.0938,622.8525,628.0938,612.8525,632.0938,616.8525,628.0938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="95.8896" x2="618.8525" y1="628.0938" y2="628.0938"/><text fill="#000000" font-family="Helvetica" font-size="10" x="102.8896" y="623.7354">(13)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="127.417" y="623.7354">GET /.well-known/oauth-authorization-server&#160;Host:  AuthS-FQDN</text><polygon fill="#181818" points="106.8896,649.7344,96.8896,653.7344,106.8896,657.7344,102.8896,653.7344" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="100.8896" x2="623.8525" y1="653.7344" y2="653.7344"/><text fill="#000000" font-family="Helvetica" font-size="10" x="112.8896" y="649.376">(14)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="137.417" y="649.376">200 OK; JSON body with Well-Known JSON Document   (RFC8414)</text><line style="stroke:#181818;stroke-width:1;" x1="95.8896" x2="137.8896" y1="679.375" y2="679.375"/><line style="stroke:#181818;stroke-width:1;" x1="137.8896" x2="137.8896" y1="679.375" y2="692.375"/><line style="stroke:#181818;stroke-width:1;" x1="96.8896" x2="137.8896" y1="692.375" y2="692.375"/><polygon fill="#181818" points="106.8896,688.375,96.8896,692.375,106.8896,696.375,102.8896,692.375" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="Helvetica" font-size="10" x="102.8896" y="675.0166">(15)</text><text fill="#000000" font-family="Helvetica" font-size="10" x="127.417" y="675.0166">Update Configuration</text><!--SRC=[jLNRRjiu47tdLqnTe4qGi7Q20ctJ6rnVucpis8tT1YtoGajZcur4gYGLr_cQVUYNT7ziXw8SoqdQNUoYJwB5CuTdpXpA8dTQvUaK3THs6etT6hENKcN2Y1HYd8aySLsjt5XU8-mtxjyy5Ib23vChT38I5KmxO0PQQPk92ECRT4ldHgAfO1DKSxTenbzowq1fXPKzYrzpL16UuGoDNxmJqUNSw5p5BPre0-SBwQe5uzi5cnuEMFtnFm7TAa6OwYHcZ-kCiGUP4VDKW4Dz3Sxao5WpSdJi1qijJFKtgFKxnpLuUBJGrWKj0CNxaP7fNz-DNLc7AI7wuWfLJ5K09U9pPzA4LY9HETeV2nMltXczL0K2W6IIgJ8JofKe43PKNQYoh80IhITaczNw6HGsrLIYep5FZk7WIGFQL6hzaPDEgtSwx0-FFh6gfADScFYkeggUtgZGCkgCBbHlCXd1oEXlgzeTN3DtYt60jWdgVseZhuMJMj44p1MQ6jmdl4hI7HGCmmpLSVj2TP5SB1Wkr42GkwR6cD8EmSZvme6UhUrwsFSlFc6Iw2KTmg7YE4WBcK4UQJMJyznW34lf5h1XXq1EG9lJOuTsU7Z5mwlTVyjvXfP27s7PCNJVjqzXvspC_MAtQDhhPqmaZi2HJbCVbHYwGNZ9lhUtMVCtD8EzlKCuwaoW_cH9FV9BHQEgYqpoI3YHw3dqA9I7K1v4nJGsJfM1W_F3SdK81uq634zUmX_ZuIaD85u5uUUUziJJXfssZlBK7q_gkwqNpmwUUGyIhJEOqQL04It0bCrovM-xL918MmobEJgsHK2gBL1JS4yJMb1IU6R8bSYHxslI-ZOxtEdmD_JuV3S4b6svtntSk3-xYGmjNRHuI_5u_UfENDuy0h3vzFKhdnXUN3BU7AytYPnolb4EFnMykQFG7CC0dOXftBV4bT8qtHaPrw_swr-Mb_Rs6TwTdnnI_3p7APpWYcBhjkZNZdv48sShi7AkXAEu-oaN3b1qjxoyj_f3Hhhz_q6uB8M1Z65Y4Veu5z6gY3ymzhyIy_ll0ELZIsBuvlrAfQX-1hajFWe__Wn2G_bQRE2gf89p-0zA2wdFd-u_lINrbwEWoFyD]--></g></svg>