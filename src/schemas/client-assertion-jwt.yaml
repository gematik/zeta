# Schema for the Client Assertion JWT
$schema: "http://json-schema.org/draft-07/schema#"
title: Client Assertion JWT
description: Schema for the payload of a Client Assertion JWT used in ZETA, as defined in RFC 7523, with custom claims for client attestation.
type: object
properties:
  header:
    type: object
    properties:
      typ:
        type: string
        description: Type of the JWT, which MUST be 'jwt'.
        enum:
          - jwt
      alg:
        type: string
        description: Algorithm used to sign the JWT, which MUST be 'ES256'.
        enum:
          - ES256
      x5c:
        type: array
        description:  Contains the certificate. The certificate must be the certificate containing the public key for verifying the signature. It must be base64-der-encoded.
        items:
          type: string
          format: byte # Represents base64 encoded data
        minItems: 1
    required:
      - typ
      - alg
      - x5c
  payload:
    type: object
    properties:
      iss:
        type: string
        description: Issuer of the JWT, which MUST be the client_id of the client.
      sub:
        type: string
        description: Subject of the JWT, which MUST be the OAuth 2.0 client_id of the client.
      aud:
        type: array
        items:
          type: string
          description: Audience for the JWT. It MUST contain the
                       Authorization Server's token endpoint URL.
        minItems: 1
      exp:
        type: integer
        description: Expiration time of the JWT in seconds since epoch.
      jti:
        type: string
        description: JWT ID, a unique identifier for the token.

      client_statement:
        description: A client statement object, as defined in client-statement.yaml. This property is optional and only present during an attestation flow.
        $ref: "client-statement.yaml"

    required:
      - iss
      - sub
      - aud
      - exp
      - jti

