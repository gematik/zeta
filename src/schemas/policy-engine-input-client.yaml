# Schema for client information used by the policy engine
$schema: "http://json-schema.org/draft-07/schema#"
type: object
properties:
  product_id:
    type: string
    description: The product identifier
  product_version:
    type: string
    description: The product version
  registration_timestamp:
    type: integer
    description: The timestamp of the registration in seconds since epoch
  platform_product_id:
    oneOf:
      - $ref: "./product-id-apple.yaml"
      - $ref: "./product-id-android.yaml"
      # TODO: Linux und Windows?
  posture:
    # TODO: posture muss zur platform passen.
    description: The posture of the client instance
    $ref: "./posture.yaml"
  attestation:
    description: The attestation information of the client instance
    $ref: "./attestation-info.yaml"
    # TODO: ist nur method enum; Anpassung erforderlich
required:
  - name
  - client_id
  - product_id
  - product_name
  - product_version
  - manufacturer_id
  - manufacturer_name
  - owner
  - owner_mail
  - registration_timestamp
  - platform
  - posture
  - attestation
