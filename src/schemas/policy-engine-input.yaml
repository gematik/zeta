# Policy Engine Input Schema for ZETA Guard
# This schema combines client-instance.yaml and user-info.yaml.
$schema: "http://json-schema.org/draft-07/schema#"
type: object
description: "Combined schema of client-instance and user-info for OPA policy decisions."
properties:
  version:
    description: The version of the schema
    type: string
  client_instance:
    description: The client-instance data
    "$ref": "./client-instance.yaml"
  user_info:
    description: The user information data
    "$ref": "./user-info.yaml"
  authorization_request:
    description: The authorization request data
    type: object
    properties:
      scopes:
        type: array
        description: The purpose of use for the authorization
        items:
          type: string
      aud:
        type: array
        description: The audience for the authorization
        items:
          type: string
    required:
      - scope
      - aud
  required:
    - client_instance
    - user_info
    - authorization_request
