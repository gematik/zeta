# Schema for client instance information used by the zero trust components
$schema: "http://json-schema.org/draft-07/schema#"
client_instance:
  type: object
  properties:
    name:
      type: string
      description: The name of the client instance, chosen by the user of the client
    client_id:
      type: string
      description: The client identifier
    manufacturer_id:
      type: string
      description: The manufacturer identifier
    manufacturer_name:
      type: string
      description: The manufacturer name
    owner_mail:
      type: string
      description: The mail address of the owner
    registration_timestamp:
      type: integer
      description: The timestamp of the registration in seconds since epoch
    platform:
      type: string
      description: The platform of the client instance
    platform_product_id:
      oneOf:
        - $ref: "./product-id-apple.yaml"
        - $ref: "./product-id-android.yaml"
        - $ref: "./product-id-windows.yaml"
        - $ref: "./product-id-linux.yaml"
    posture:
      description: The posture of the client instance, including platform-specific attestation data
      $ref: "./posture.yaml"
  required:
    - name
    - client_id
    - manufacturer_id
    - manufacturer_name
    - owner_mail
    - registration_timestamp
    - platform
    - platform_product_id
    - posture
